geom_hline(aes(yintercept=0), colour="grey",linetype=3)+
my_theme()+ggtitle("B)"),
ncol=2,left=textGrob("Correlation (Moran's I)",just="center",
hjust=0.42,
gp=gpar(fontsize=16,fontfamily="serif"),
rot = 90))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/neighbourhood_effects/results/plant/figures/figA1.tiff",
plot=figA1,device="tiff",width=22,height=9,units="cm",dpi=300,
compression="lzw")
AIC(model1,model1_ME,model1_SAR)
AIC(model2,model2_ME,model2_SAR)
cor(allplants$meanT,allplants$moist_per)
subset1<-subset(allplants,!is.na(phen_int))
subset2<-subset(allplants,!is.na(phen_int)&!is.na(seeds_per_fl))
mod1<-lm(phen_int~meanT*moist_per,subset1,na.action=na.fail)
mod2<-glm.nb(round(Mrub_sum)~meanT*moist_per,allplants,na.action=na.fail)
mod3<-lm(pldens_3~meanT*moist_per,allplants,na.action=na.fail)
mod3_nb<-glm.nb(round(pldens_3)~meanT*moist_per,allplants,
na.action=na.fail) # USE
mod4<-lm(phen_n3~meanT*moist_per,allplants,na.action=na.fail)
mod5<-glm(as.integer(attack)~phen_int+round(Mrub_sum)+phen_int:round(Mrub_sum)+
pldens_3+phen_n3+pldens_3:phen_n3+meanT*moist_per,
subset1,family="binomial",na.action=na.fail)
mod5_1<-glm(as.integer(attack)~phen_int+round(Mrub_sum)+phen_int:round(Mrub_sum)+
pldens_3+phen_n3+pldens_3:phen_n3+meanT+moist_per,
subset1,family="binomial",na.action=na.fail)
# Removed interaction meanT*moist_per because NS
mod6<-lm(seeds_per_fl~phen_int+as.integer(attack)+meanT*moist_per,subset2,
na.action=na.fail)
mod6_1<-lm(seeds_per_fl~phen_int+as.integer(attack)+meanT+moist_per,subset2,
na.action=na.fail) # Removed interaction meanT*moist_per because NS
AIC(mod3,mod3_nb)
AIC(mod5,mod5_1)
AIC(mod6,mod6_1)
simulationOutput_mod1<-simulateResiduals(fittedModel=mod1,n=5000)
simulationOutput_mod2<-simulateResiduals(fittedModel=mod2,n=5000)
simulationOutput_mod3<-simulateResiduals(fittedModel=mod3,n=5000)
simulationOutput_mod3_nb<-simulateResiduals(fittedModel=mod3_nb,n=5000)
simulationOutput_mod4<-simulateResiduals(fittedModel=mod4,n=5000)
simulationOutput_mod5<-simulateResiduals(fittedModel=mod5,n=5000)
simulationOutput_mod5_1<-simulateResiduals(fittedModel=mod5_1,n=5000)
simulationOutput_mod6<-simulateResiduals(fittedModel=mod6,n=5000)
simulationOutput_mod6_1<-simulateResiduals(fittedModel=mod6_1,n=5000)
plot(simulationOutput_mod1)
plot(simulationOutput_mod2)
plot(simulationOutput_mod3)
plot(simulationOutput_mod3_nb)
plot(simulationOutput_mod4)
plot(simulationOutput_mod5)
plot(simulationOutput_mod5_1)
plot(simulationOutput_mod6)
plot(simulationOutput_mod6_1)
vif(lm(phen_int~meanT+moist_per,subset1,na.action=na.fail))
vif(glm.nb(round(Mrub_sum)~meanT+moist_per,allplants,na.action=na.fail))
vif(glm.nb(round(pldens_3)~meanT+moist_per,allplants,na.action=na.fail))
vif(lm(phen_n3~meanT+moist_per,allplants,na.action=na.fail))
vif(glm(as.integer(attack)~phen_int+round(Mrub_sum)+pldens_3+phen_n3+
meanT+moist_per,subset1,family="binomial",na.action=na.fail))
vif(lm(seeds_per_fl~phen_int+as.integer(attack)+meanT+moist_per,subset2,
na.action=na.fail))
plot(correlog_mod1)
plot(correlog_mod2)
plot(correlog_mod3)
plot(correlog_mod3_nb)
plot(correlog_mod4)
plot(correlog_mod5)
plot(correlog_mod5_1)
plot(correlog_mod6)
plot(correlog_mod6_1)
load("C:/Users/User/Dropbox/SU/Projects/neighbourhood_effects/4_models_plant/allplants.listw1.R")
moran_mod1 # Significant autocorrelation in the residuals of mod1
moran_mod2 # Significant autocorrelation in the residuals of mod2
moran_mod3 # Significant autocorrelation in the residuals of mod3
moran_mod3_nb # Significant autocorrelation in the residuals of mod3_nb
moran_mod4 # Significant autocorrelation in the residuals of mod4
moran_mod5 # Significant autocorrelation in the residuals of mod5
moran_mod5_1 # Significant autocorrelation in the residuals of mod5_1
moran_mod6 # No significant autocorrelation in the residuals of mod6
moran_mod6_1 # No significant autocorrelation in the residuals of mod6_1
mod1_ME<-lm(phen_int~meanT*moist_per+ME.mod1$vectors[,1]+ME.mod1$vectors[,2],
subset1,na.action=na.fail)
mod2_ME<-glm.nb(round(Mrub_sum)~meanT*moist_per+ME.mod2$vectors[,1],allplants,
na.action=na.fail)
mod3_nb_ME<-glm.nb(round(pldens_3)~meanT*moist_per+
ME.mod3_nb$vectors[,1]+ME.mod3_nb$vectors[,2],
allplants,
na.action=na.fail)
mod4_ME<-lm(phen_n3~meanT*moist_per+ME.mod4$vectors[,1]+ME.mod4$vectors[,2]+
ME.mod4$vectors[,3]+ME.mod4$vectors[,4]+
ME.mod4$vectors[,5],allplants,na.action=na.fail)
mod5_1_ME<-glm(as.integer(attack)~phen_int+round(Mrub_sum)+
phen_int:round(Mrub_sum)+pldens_3+phen_n3+pldens_3:phen_n3+
meanT+moist_per+ME.mod5_1$vectors[,1],
subset1,family="binomial",na.action=na.fail)
summary(mod1_ME)
summary(mod2_ME)
summary(mod3_nb_ME)
summary(mod4_ME)
summary(mod5_ME_1)
summary(mod6_1)
plot(correlog_mod1_ME)
plot(correlog_mod2_ME)
plot(correlog_mod3_nb_ME)
plot(correlog_mod4_ME)
plot(correlog_mod5_1_ME)
moran_mod1_ME # No significant autocorrelation in the residuals of mod1_ME
moran_mod2_ME # No significant autocorrelation in the residuals of mod2_ME
moran_mod3_nb_ME # No significant autocorrelation in the residuals of mod3_nb_ME
moran_mod4_ME # No significant autocorrelation in the residuals of mod4_ME
moran_mod5_1_ME # Significant autocorrelation in the residuals of mod5_1_ME
# mod1
corr_mod1<-data.frame(cbind(distance=as.vector(correlog_mod1$mean.of.class[1:31]),
correlation=as.vector(correlog_mod1$correlation[1:31]),
p=as.vector(correlog_mod1$p[1:31])))
corr_mod1_ME<-data.frame(cbind(distance=as.vector(correlog_mod1_ME$mean.of.class[1:31]),
correlation=as.vector(correlog_mod1_ME$correlation[1:31]),
p=as.vector(correlog_mod1_ME$p[1:31])))
corr_mod1$type<-"mod1"
corr_mod1_ME$type<-"mod1_ME"
corr_sem_1<-rbind(corr_mod1,corr_mod1_ME)
corr_sem_1$sig<-as.factor(ifelse(corr_sem_1$p<0.05,1,0))
# mod2
corr_mod2<-data.frame(cbind(distance=as.vector(correlog_mod2$mean.of.class[1:31]),
correlation=as.vector(correlog_mod2$correlation[1:31]),
p=as.vector(correlog_mod2$p[1:31])))
corr_mod2_ME<-data.frame(cbind(distance=as.vector(correlog_mod2_ME$mean.of.class[1:31]),
correlation=as.vector(correlog_mod2_ME$correlation[1:31]),
p=as.vector(correlog_mod2_ME$p[1:31])))
corr_mod2$type<-"mod2"
corr_mod2_ME$type<-"mod2_ME"
corr_sem_2<-rbind(corr_mod2,corr_mod2_ME)
corr_sem_2$sig<-as.factor(ifelse(corr_sem_2$p<0.05,1,0))
# mod3
corr_mod3<-data.frame(cbind(distance=as.vector(correlog_mod3_nb$mean.of.class[1:31]),
correlation=as.vector(correlog_mod3_nb$correlation[1:31]),
p=as.vector(correlog_mod3_nb$p[1:31])))
corr_mod3_ME<-data.frame(cbind(distance=as.vector(correlog_mod3_nb_ME$mean.of.class[1:31]),
correlation=as.vector(correlog_mod3_nb_ME$correlation[1:31]),
p=as.vector(correlog_mod3_nb_ME$p[1:31])))
corr_mod3$type<-"mod3"
corr_mod3_ME$type<-"mod3_ME"
corr_sem_3<-rbind(corr_mod3,corr_mod3_ME)
corr_sem_3$sig<-as.factor(ifelse(corr_sem_3$p<0.05,1,0))
# mod4
corr_mod4<-data.frame(cbind(distance=as.vector(correlog_mod4$mean.of.class[1:31]),
correlation=as.vector(correlog_mod4$correlation[1:31]),
p=as.vector(correlog_mod4$p[1:31])))
corr_mod4_ME<-data.frame(cbind(distance=as.vector(correlog_mod4_ME$mean.of.class[1:31]),
correlation=as.vector(correlog_mod4_ME$correlation[1:31]),
p=as.vector(correlog_mod4_ME$p[1:31])))
corr_mod4$type<-"mod4"
corr_mod4_ME$type<-"mod4_ME"
corr_sem_4<-rbind(corr_mod4,corr_mod4_ME)
corr_sem_4$sig<-as.factor(ifelse(corr_sem_4$p<0.05,1,0))
# mod5
corr_mod5<-data.frame(cbind(distance=as.vector(correlog_mod5_1$mean.of.class[1:31]),
correlation=as.vector(correlog_mod5_1$correlation[1:31]),
p=as.vector(correlog_mod5_1$p[1:31])))
corr_mod5_ME<-data.frame(cbind(distance=as.vector(correlog_mod5_1_ME$mean.of.class[1:31]),
correlation=as.vector(correlog_mod5_1_ME$correlation[1:31]),
p=as.vector(correlog_mod5_1_ME$p[1:31])))
corr_mod5$type<-"mod5"
corr_mod5_ME$type<-"mod5_ME"
corr_sem_5<-rbind(corr_mod5,corr_mod5_ME)
corr_sem_5$sig<-as.factor(ifelse(corr_sem_5$p<0.05,1,0))
# mod6
corr_sem_6<-data.frame(cbind(distance=as.vector(correlog_mod6_1$mean.of.class[1:31]),
correlation=as.vector(correlog_mod6_1$correlation[1:31]),
p=as.vector(correlog_mod6_1$p[1:31])))
corr_sem_6$sig<-as.factor(ifelse(corr_sem_6$p<0.05,1,0))
figA2<-grid.arrange(
ggplot(corr_sem_1,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type,shape=sig),size=2) +
geom_line(aes(colour=type)) + xlab(NULL) + ylab(NULL)+
scale_x_continuous(limits=c(0,30),
breaks=c(0,10,20,30)) +
scale_y_continuous(limits=c(-0.1,0.4),
breaks = c(-0.1,0,0.1,0.20,0.30,0.40))+
scale_shape_manual(values=c(1,19))+
scale_color_manual(values=c("black","darkgrey"))+
geom_hline(aes(yintercept=0), colour="grey",linetype=3)+
my_theme()+ggtitle("Component model 1")+
annotation_custom(grobTree(textGrob("Global Moran's I = 0.006, p = 0.001",
x=0.18,y=0.95,hjust=0,
gp=gpar(col="black",fontsize=16,
fontfamily="serif"))))+
annotation_custom(grobTree(textGrob("Global Moran's I = 0.000, p = 0.113",
x=0.18,y=0.85,hjust=0,
gp=gpar(col="darkgrey",fontsize=16,
fontfamily="serif")))),
ggplot(corr_sem_2,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type,shape=sig),size=2) +
geom_line(aes(colour=type)) + xlab(NULL) + ylab(NULL)+
scale_x_continuous(limits=c(0,30),
breaks=c(0,10,20,30)) +
scale_y_continuous(limits=c(-0.4,1.2),
breaks = c(-0.4,-0.2,0,0.2,0.4,0.6,0.8,1,1.2))+
scale_shape_manual(values=c(19,1))+
scale_color_manual(values=c("black","darkgrey"))+
geom_hline(aes(yintercept=0), colour="grey",linetype=3)+
my_theme()+ggtitle("Component model 2")+
annotation_custom(grobTree(textGrob("Global Moran's I = 0.004, p = 0.001",
x=0.18,y=0.95,hjust=0,
gp=gpar(col="black",fontsize=16,
fontfamily="serif"))))+
annotation_custom(grobTree(textGrob("Global Moran's I = -0.002, p = 0.999",
x=0.18,y=0.85,hjust=0,
gp=gpar(col="darkgrey",fontsize=16,
fontfamily="serif")))),
ggplot(corr_sem_3,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type,shape=sig),size=2) +
geom_line(aes(colour=type)) + xlab(NULL) + ylab(NULL)+
scale_x_continuous(limits=c(0,30),
breaks=c(0,10,20,30)) +
scale_y_continuous(limits=c(-0.5,1.25),
breaks = seq(-0.5,1.25,0.25))+
scale_shape_manual(values=c(1,19))+
scale_color_manual(values=c("black","darkgrey"))+
geom_hline(aes(yintercept=0), colour="grey",linetype=3)+
my_theme()+ggtitle("Component model 3")+
annotation_custom(grobTree(textGrob("Global Moran's I = 0.085, p = 0.001",
x=0.18,y=0.95,hjust=0,
gp=gpar(col="black",fontsize=16,
fontfamily="serif"))))+
annotation_custom(grobTree(textGrob("Global Moran's I = -0.010, p = 0.999",
x=0.18,y=0.85,hjust=0,
gp=gpar(col="darkgrey",fontsize=16,
fontfamily="serif")))),
ggplot(corr_sem_4,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type,shape=sig),size=2) +
geom_line(aes(colour=type)) + xlab(NULL) + ylab(NULL)+
scale_x_continuous(limits=c(0,30),
breaks=c(0,10,20,30)) +
scale_y_continuous(limits=c(-0.25,1),
breaks =seq(-0.25,1,0.25))+
scale_shape_manual(values=c(19,1))+
scale_color_manual(values=c("black","darkgrey"))+
geom_hline(aes(yintercept=0), colour="grey",linetype=3)+
my_theme()+ggtitle("Component model 4")+
annotation_custom(grobTree(textGrob("Global Moran's I = 0.101, p = 0.001",
x=0.18,y=0.95,hjust=0,
gp=gpar(col="black",fontsize=16,
fontfamily="serif"))))+
annotation_custom(grobTree(textGrob("Global Moran's I = 0.000, p = 0.651",
x=0.18,y=0.85,hjust=0,
gp=gpar(col="darkgrey",fontsize=16,
fontfamily="serif")))),
ggplot(corr_sem_5,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type,shape=sig),size=2) +
geom_line(aes(colour=type)) + xlab(NULL) + ylab(NULL)+
scale_x_continuous(limits=c(0,30),
breaks=c(0,10,20,30)) +
scale_y_continuous(limits=c(-0.05,0.25),
breaks =seq(-0.05,0.25,0.05))+
scale_shape_manual(values=c(1,19))+
scale_color_manual(values=c("black","darkgrey"))+
geom_hline(aes(yintercept=0), colour="grey",linetype=3)+
my_theme()+ggtitle("Component model 5")+
annotation_custom(grobTree(textGrob("Global Moran's I = 0.007, p = 0.001",
x=0.18,y=0.95,hjust=0,
gp=gpar(col="black",fontsize=16,
fontfamily="serif"))))+
annotation_custom(grobTree(textGrob("Global Moran's I = 0.000, p = 0.024",
x=0.18,y=0.85,hjust=0,
gp=gpar(col="darkgrey",fontsize=16,
fontfamily="serif")))),
ggplot(corr_sem_6,aes(x=distance, y=correlation)) +
geom_point(aes(shape=sig),size=2,colour="black") +
geom_line(colour="black") + xlab(NULL) + ylab(NULL)+
scale_x_continuous(limits=c(0,30),
breaks=c(0,10,20,30)) +
scale_y_continuous(limits=c(-0.05,0.15),
breaks =seq(-0.05,0.15,0.05))+
scale_shape_manual(values=c(1,19))+
geom_hline(aes(yintercept=0), colour="grey",linetype=3)+
my_theme()+ggtitle("Component model 6")+
annotation_custom(grobTree(textGrob("Global Moran's I = -0.004, p = 0.591",
x=0.18,y=0.95,hjust=0,
gp=gpar(col="black",fontsize=16,
fontfamily="serif")))),
ncol=2,
left=textGrob("Correlation (Moran's I)",just="center",
hjust=0.42,gp=gpar(fontsize=16,fontfamily="serif"),rot=90),
bottom=textGrob("Distance (mean of class)",just="center",
hjust=0.42,gp=gpar(fontsize=16,fontfamily="serif")))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/neighbourhood_effects/results/plant/figures/figA2.tiff",
plot=figA2,device="tiff",width=25,height=30,units="cm",dpi=300,
compression="lzw")
vector1_1<-data.frame(FID=subset(allplants,!is.na(phen_int))$FID,
vector1_1=ME.mod1$vectors[,1])
vector1_2<-data.frame(FID=subset(allplants,!is.na(phen_int))$FID,
vector1_2=ME.mod1$vectors[,2])
vector2_1<-data.frame(FID=allplants$FID,vector2_1=ME.mod2$vectors[,1])
vector3_1<-data.frame(FID=allplants$FID,vector3_1=ME.mod3_nb$vectors[,1])
vector3_2<-data.frame(FID=allplants$FID,vector3_2=ME.mod3_nb$vectors[,2])
vector4_1<-data.frame(FID=allplants$FID,vector4_1=ME.mod4$vectors[,1])
vector4_2<-data.frame(FID=allplants$FID,vector4_2=ME.mod4$vectors[,2])
vector4_3<-data.frame(FID=allplants$FID,vector4_3=ME.mod4$vectors[,3])
vector4_4<-data.frame(FID=allplants$FID,vector4_4=ME.mod4$vectors[,4])
vector4_5<-data.frame(FID=allplants$FID,vector4_5=ME.mod4$vectors[,5])
vector5_1<-data.frame(FID=subset(allplants,!is.na(phen_int))$FID,
vector5_1=ME.mod5_1$vectors[,1])
allplants_df<-data.frame(allplants)%>%
full_join(vector1_1)%>%full_join(vector1_2)%>%full_join(vector2_1)%>%
full_join(vector3_1)%>%full_join(vector3_2)%>%full_join(vector4_1)%>%
full_join(vector4_2)%>%full_join(vector4_3)%>%full_join(vector4_4)%>%
full_join(vector4_5)%>%full_join(vector5_1)
allplants_df$Mrub_sum_round<-round(allplants_df$Mrub_sum)
allplants_df$pldens_3_round<-round(allplants_df$pldens_3)
sem1<-psem(
# Model 1)
lm(phen_int~meanT*moist_per,subset(allplants_df,!is.na(phen_int))),
# Model 2)
glm.nb(Mrub_sum_round~meanT*moist_per,allplants_df),
# Model 3)
glm.nb(pldens_3_round~meanT*moist_per,allplants_df),
# Model 4)
lm(phen_n3~meanT*moist_per,allplants_df),
# Model 5)
glm(as.integer(attack)~phen_int*Mrub_sum_round+pldens_3_round*phen_n3+
meanT+moist_per,subset(allplants_df,!is.na(phen_int)),
family="binomial"),
# Model 6)
lm(seeds_per_fl~phen_int+as.integer(attack)+meanT+moist_per,
subset(allplants_df,!is.na(phen_int)))
)
summary(sem1,conserve=TRUE)
sem1<-psem(
# Model 1)
lm(phen_int~meanT*moist_per,subset(allplants_df,!is.na(phen_int))),
# Model 2)
glm.nb(Mrub_sum_round~meanT*moist_per,allplants_df),
# Model 3)
glm.nb(pldens_3_round~meanT*moist_per,allplants_df),
# Model 4)
lm(phen_n3~meanT*moist_per,allplants_df),
# Model 5)
glm(as.integer(attack)~phen_int*Mrub_sum_round+pldens_3_round*phen_n3+
meanT+moist_per,subset(allplants_df,!is.na(phen_int)),
family="binomial"),
# Model 6)
lm(seeds_per_fl~phen_int+as.integer(attack)+meanT+moist_per,
subset(allplants_df,!is.na(phen_int))),
# Correlated errors
phen_n3 %~~% phen_int,phen_n3 %~~% pldens_3_round,phen_n3 %~~% Mrub_sum_round,
pldens_3_round %~~% Mrub_sum_round,Mrub_sum_round %~~% phen_int,
pldens_3_round %~~% phen_int
)
summary(sem1)
summary(mod1_ME)
summary(mod2_ME)
summary(mod3_nb_ME)
summary(mod4_ME)
summary(mod5_ME_1)
summary(mod6_1)
# moist_per --> attack: * without ME vectors, but NS with ME vectors
# Refit mod5 without most_per and check for autocorrelation in residuals
mod5_2<-glm(as.integer(attack)~phen_int+round(Mrub_sum)+phen_int:round(Mrub_sum)+
pldens_3+phen_n3+pldens_3:phen_n3+meanT,
subset1,family="binomial",na.action=na.fail)
moran_mod5_2
seeds_P_UP<-seeds%>%
mutate(seeds_UP=rowSums(.[c(3,5)],na.rm=T),
seeds_P=rowSums(.[c(2,4)],na.rm=T))%>%
select(c("pl_id","seeds_UP","seeds_P"))%>%
pivot_longer(cols=seeds_UP:seeds_P,names_to="P_UP",values_to="seeds")
ggplot(seeds_P_UP,aes(x=P_UP,y=seeds))+geom_boxplot()
summary(lm(seeds~P_UP,seeds_P_UP))
summary(glm(seeds~P_UP,seeds_P_UP,family=poisson))
summary(glm.nb(seeds~P_UP,seeds_P_UP))
seeds_P_UP%>%
group_by(P_UP)%>%
summarise(mean=mean(seeds),sd=sd(seeds))
str(mem.select)
str(prueba)
head(prueba$MEM.select)
ME.mod5_1
head(ME.mod5_1$vectors)
summary(mod5_1_ME)
summary(glm(as.integer(attack)~phen_int+round(Mrub_sum)+
phen_int:round(Mrub_sum)+pldens_3+phen_n3+pldens_3:phen_n3+
meanT+moist_per+prueba$MEM.select,
subset1,family="binomial",na.action=na.fail))
str(prueba$MEM.select)
head(prueba$MEM.select)
head(prueba$MEM.select$MEM2)
head(ME.mod5_1$vectors[,1])
str(prueba$MEM.select$MEM2)
str(ME.mod5_1$vectors[,1])
summary(mod5_1_ME)
summary(glm(as.integer(attack)~phen_int+round(Mrub_sum)+
phen_int:round(Mrub_sum)+pldens_3+phen_n3+pldens_3:phen_n3+
meanT+moist_per+prueba$MEM.select$MEM2,
subset1,family="binomial",na.action=na.fail))
summary(glm(as.integer(attack)~phen_int+round(Mrub_sum)+
phen_int:round(Mrub_sum)+pldens_3+phen_n3+pldens_3:phen_n3+
meanT+moist_per+prueba$MEM.select$MEM2,
subset1,family="binomial",na.action=na.fail))
summary(mod5_1_ME)
prueba2<-mem.select(
x=residuals(mod5_1),
listw=allplants.listw1,
MEM.autocor = "all",
method = "FWD",
MEM.all = TRUE,
nperm = 99,
nperm.global = 999,
alpha = 0.05,
verbose = TRUE)
prueba2
str(prueba2)
str(prueba2)
save.image("C:/Users/User/Dropbox/SU/Projects/neighbourhood_effects/4_models_plant/.RData")
head(prueba2$summary)
sem1<-psem(
# Model 1)
lm(phen_int~meanT*moist_per,subset(allplants_df,!is.na(phen_int))),
# Model 2)
glm.nb(Mrub_sum_round~meanT*moist_per,allplants_df),
# Model 3)
glm.nb(pldens_3_round~meanT*moist_per,allplants_df),
# Model 4)
lm(phen_n3~meanT*moist_per,allplants_df),
# Model 5)
glm(as.integer(attack)~phen_int*Mrub_sum_round+pldens_3_round*phen_n3+
meanT+moist_per,subset(allplants_df,!is.na(phen_int)),
family="binomial"),
# Model 6)
lm(seeds_per_fl~phen_int+as.integer(attack)+meanT+moist_per,
subset(allplants_df,!is.na(phen_int))),
# Correlated errors
phen_n3 %~~% phen_int,phen_n3 %~~% pldens_3_round,phen_n3 %~~% Mrub_sum_round,
pldens_3_round %~~% Mrub_sum_round,
pldens_3_round %~~% phen_int
)
summary(sem1)
sem1<-psem(
# Model 1)
lm(phen_int~meanT*moist_per,subset(allplants_df,!is.na(phen_int))),
# Model 2)
glm.nb(Mrub_sum_round~meanT*moist_per,allplants_df),
# Model 3)
glm.nb(pldens_3_round~meanT*moist_per,allplants_df),
# Model 4)
lm(phen_n3~meanT*moist_per,allplants_df),
# Model 5)
glm(as.integer(attack)~phen_int*Mrub_sum_round+pldens_3_round*phen_n3+
meanT+moist_per,subset(allplants_df,!is.na(phen_int)),
family="binomial"),
# Model 6)
lm(seeds_per_fl~phen_int+as.integer(attack)+meanT+moist_per,
subset(allplants_df,!is.na(phen_int))),
# Correlated errors
phen_n3 %~~% phen_int,phen_n3 %~~% pldens_3_round,phen_n3 %~~% Mrub_sum_round,
pldens_3_round %~~% Mrub_sum_round,Mrub_sum_round %~~% phen_int,
pldens_3_round %~~% phen_int
)
summary(sem1)
summary(sem1)
prueba2$summary
str(prueba2)
head(prueba2$MEM.select)
head(prueba2$MEM.select$MEM2)
head(prueba2$MEM.select[$MEM9]1:"")
head(prueba2$MEM.select[1:2])
head(prueba2$MEM.select[1])
head(prueba2$MEM.select[2])
summary(glm(as.integer(attack)~phen_int+round(Mrub_sum)+
phen_int:round(Mrub_sum)+pldens_3+phen_n3+pldens_3:phen_n3+
meanT+moist_per+prueba2$MEM.select[1]+prueba2$MEM.select[2],
subset1,family="binomial",na.action=na.fail))
summary(glm(as.integer(attack)~phen_int+round(Mrub_sum)+
phen_int:round(Mrub_sum)+pldens_3+phen_n3+pldens_3:phen_n3+
meanT+moist_per+prueba2$MEM.select$MEM2+prueba2$MEM.select$MEM9,
subset1,family="binomial",na.action=na.fail))
summary(mod5_ME_1)
model_prueba2<-glm(as.integer(attack)~phen_int+round(Mrub_sum)+
phen_int:round(Mrub_sum)+pldens_3+phen_n3+pldens_3:phen_n3+
meanT+moist_per+prueba2$MEM.select$MEM2+prueba2$MEM.select$MEM9,
subset1,family="binomial",na.action=na.fail)
summary(model_prueba2)
moran.test(model_prueba2)
moran.test(model_prueba2,listw=allplants.listw1)
moran.test(residuals(model_prueba2),listw=allplants.listw1)
moran_mod5_1_ME
moran_model_prueba2<- moran.mc(residuals(model_prueba2),listw=allplants.listw1,nsim=999)
moran_model_prueba2
head(prueba2$summary)
model_prueba2<-glm(as.integer(attack)~phen_int+round(Mrub_sum)+
phen_int:round(Mrub_sum)+pldens_3+phen_n3+pldens_3:phen_n3+
meanT+moist_per+prueba2$MEM.select$MEM2+prueba2$MEM.select$MEM9+
prueba2$MEM.select$MEM56,
subset1,family="binomial",na.action=na.fail)
summary(model_prueba2)
summary(mod5_ME_1)
moran_model_prueba2
model_prueba2
moran_model_prueba2<- moran.mc(residuals(model_prueba2),listw=allplants.listw1,nsim=999)
beep()
moran_model_prueba2
head(MEM.select$summary)
head(prueba2$summary)
model_prueba2<-glm(as.integer(attack)~phen_int+round(Mrub_sum)+
phen_int:round(Mrub_sum)+pldens_3+phen_n3+pldens_3:phen_n3+
meanT+moist_per+prueba2$MEM.select$MEM2+prueba2$MEM.select$MEM9+
prueba2$MEM.select$MEM56+prueba2$MEM.select$MEM5,
subset1,family="binomial",na.action=na.fail)
summary(model_prueba2)
moran_model_prueba2<- moran.mc(residuals(model_prueba2),listw=allplants.listw1,nsim=999)
moran_model_prueba2
beep()
summary(model_prueba2)
