?sem.fit
get.dag(sem5)
get.basis.set(sem5)
get.formula.list(sem5)
get.model.control(sem5)
get.scaled.model(sem5)
sem.basis.set(sem5)
sem.predict(sem5)
sem.plot(sem5)
head(seeds)
hist(allplants$seeds_per_fl)
sem.fit(sem6, data=subset(allplants_seeds,!is.na(phen)&seeds_per_fl<2000)) #p=0
sem.coefs(sem4, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
hist(allplants_seeds$seeds_per_fl)
par(mfrow=c(1,1))
hist(allplants_seeds$seeds_per_fl)
hist(subset(allplants_seeds,seeds_per_fl<2000)$seeds_per_fl)
hist(log(subset(allplants_seeds,seeds_per_fl<2000)$seeds_per_fl))
summary(glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants_seeds,seeds_per_fl<2000)))
summary(glm(log(seeds_per_fl+1)~phen_int+meanT+moist_per+attack,data=subset(allplants_seeds,seeds_per_fl<2000)))
hist(log(subset(allplants_seeds,seeds_per_fl<2000)$seeds_per_fl+1))
summary(glm(seeds_per_fl~phen_int+meanT+moist_per+attack,family="poisson",data=subset(allplants_seeds,seeds_per_fl<2000)))
warnings()
hist(log(subset(allplants_seeds,seeds_per_fl<2000)$seeds_per_fl))
hist(subset(allplants_seeds,seeds_per_fl<2000)$seeds_per_fl)
hist(allplants_seeds$seeds_per_fl)
subset(allplants_seeds,seeds_per_fl>2000)
subset(seeds,seeds_per_fl>2000)
5540/2
View(seeds)
seeds<-read.table("D:/SU/projects/neighbourhood_effects/data/raw/tanga2016_seeds.txt",header=T,sep="\t",dec=".")
head(seeds)
View(seeds)
subset(allplants_seeds,pl_id==159)
allplants$fr_in[153]=3
allplants$fr_inC[153]=0
allplants$fr_pr[153]=1
allplants$fr_prC[153]=1
subset(allplants_seeds,pl_id==159)
sem1<-list(#density and phenology of neighbours
lm(phen_int~meanT*moist_per,subset(allplants,!is.na(phen))),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants,!is.na(phen))),
lm(pldens_3~meanT*moist_per,subset(allplants,!is.na(phen))),
lm(phen_n3~meanT*moist_per,subset(allplants,!is.na(phen))),
glm(attack~phen_int*Mrub_sch_s+pldens_3*phen_n3+meanT+moist_per,subset(allplants,!is.na(phen)),family="binomial")
)
allplants$fr_in[153]
subset(allplants,pl_id==159)
load(file="allplants.R")
subset(allplants,pl_id==159)
allplants$fr_in[4486]=3
allplants$fr_inC[4486]=0
allplants$fr_pr[4486]=1
allplants$fr_prC[4486]=1
subset(allplants,pl_id==159)
subset(allplants,pl_id==196)
subset(allplants,pl_id==197)
subset(allplants,pl_id==198)
subset(allplants,pl_id==195)
subset(allplants,pl_id==19)
subset(allplants,pl_id==196)
subset(allplants,pl_id==211)
subset(allplants,pl_id==210)
subset(allplants,pl_id==200)
subset(allplants,pl_id==211)
subset(allplants,pl_id==517)
allplants$fr_in[7626]=4
allplants$fr_inC[7626]=0
allplants$fr_pr[7626]=1
allplants$fr_prC[7626]=1
subset(allplants,pl_id==517)
sem1<-list(#density and phenology of neighbours
lm(phen_int~meanT*moist_per,subset(allplants,!is.na(phen))),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants,!is.na(phen))),
lm(pldens_3~meanT*moist_per,subset(allplants,!is.na(phen))),
lm(phen_n3~meanT*moist_per,subset(allplants,!is.na(phen))),
glm(attack~phen_int*Mrub_sch_s+pldens_3*phen_n3+meanT+moist_per,subset(allplants,!is.na(phen)),family="binomial")
)
sem.fit(sem1, data=subset(allplants,!is.na(phen)),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~pldens_3","pldens_3~~Mrub_sch_s",
"phen_n3~~phen_int","phen_n3~~Mrub_sch_s","phen_n3~~pldens_3"))
sem.fit(sem1, data=subset(allplants,!is.na(phen))
)
sem2<-list(#only density of neighbours
lm(phen_int~meanT*moist_per,subset(allplants,!is.na(phen))),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants,!is.na(phen))),
lm(pldens_3~meanT*moist_per,subset(allplants,!is.na(phen))),
glm(attack~phen_int*Mrub_sch_s+pldens_3+meanT+moist_per,subset(allplants,!is.na(phen)),family="binomial")
)
allplants$suit_neigh
allplants$suit_neigh<-allplants$pldens_3*allplants$phen_n3
hist(allplants$suit_neigh)
sem3<-list(#suitability of neighbours
lm(phen_int~meanT*moist_per,subset(allplants,!is.na(phen))),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants,!is.na(phen))),
lm(suit_neigh~meanT*moist_per,subset(allplants,!is.na(phen))),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants,!is.na(phen)),family="binomial")
)
allplants$fruitset<-allplants$fr_in/allplants$n_fl
subset(allplants,fruitset>1) #5 cases
allplants$n_fl<-ifelse(allplants$fr_in>allplants$n_fl,allplants$n_fr,allplants$n_fl)
?ifelse
allplants$n_fl_new<-ifelse(allplants$fr_in>allplants$n_fl,allplants$n_fr,allplants$n_fl)
allplants$n_fl_new<-ifelse(allplants$fr_in>allplants$n_fl,n_fr,n_fl)
allplants$n_fl_new<-ifelse(allplants$fr_in>allplants$n_fl,"allplants$n_fr","allplants$n_fl")
allplants$n_fl_new
head(allplants)
allplants$n_fl_new<-ifelse(is.na(allplants$n_fr),n_fl,ifelse(allplants$fr_in>allplants$n_fl,allplants$n_fr,allplants$n_fl))
allplants$n_fl_new<-ifelse(is.na(allplants$fr_in),n_fl,ifelse(allplants$fr_in>allplants$n_fl,allplants$fr_in,allplants$n_fl))
allplants$n_fl_new<-ifelse(is.na(allplants$fr_in),allplants$n_fl,ifelse(allplants$fr_in>allplants$n_fl,allplants$fr_in,allplants$n_fl))
subset(allplants,fruitset>1) #5 cases
head(allplants)
allplants$n_fl_new<-NULL
allplants$n_fl<-ifelse(is.na(allplants$fr_in),allplants$n_fl,ifelse(allplants$fr_in>allplants$n_fl,allplants$fr_in,allplants$n_fl))
subset(allplants,fruitset>1) #5 cases
allplants$fruitset<-ifelse(allplants$fruitset>1,1,allplants$fruitset)
sem4<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants,family="binomial"),
glm(cbind(fr_in,n_fl)~phen_int+meanT+moist_per+attack,allplants,family="binomial")
)
sem.fit(sem4, data=allplants) #p=0
hist(cbind(allplants$fr_in,allplants$n_fl))
cbind(fr_in,n_fl)
cbind(allplants$fr_in,allplants$n_fl)
sem4<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants,family="binomial"),
glm(cbind(fr_in,n_fl)~phen_int+meanT+moist_per+attack,allplants,family="binomial")
)
sem.fit(sem4, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem4)
sem.coefs(sem4, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem5<-list(#with fitness, number of eggs (only pls w eggs)
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm.nb(n_eggs_max~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants,n_eggs_max>0)),
glm(cbind(fr_in,n_fl)~phen_int+meanT+moist_per+n_eggs_max,subset(allplants,n_eggs_max>0),family="binomial")
)
sem.fit(sem5, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem5<-list(#with fitness, number of eggs (only pls w eggs)
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm.nb(n_eggs_max~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants,n_eggs_max>0)),
glm(cbind(fr_in,n_fl)~phen_int+meanT+moist_per+n_eggs_max,subset(allplants,n_eggs_max>0),family="binomial")
)
sem.fit(sem5, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem5)
sem.coefs(sem5, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
seeds<-read.table("D:/SU/projects/neighbourhood_effects/data/raw/tanga2016_seeds.txt",header=T,sep="\t",dec=".")
head(seeds)
seeds<-subset(seeds,!is.na(n_dev_seeds))
seeds <- dcast(seeds, pl_id_ALL ~ inmature+P_UP, value.var="n_dev_seeds")
library(data.table)
seeds <- dcast(seeds, pl_id_ALL ~ inmature+P_UP, value.var="n_dev_seeds")
head(seeds)
names(seeds)<-c("pl_id","P_m","UP_m","P_i","UP_i")
seeds$status<-ifelse(!is.na(seeds$P_i)&!is.na(seeds$UP_i),"Both_i",
ifelse(!is.na(seeds$P_i),"P_i",ifelse(!is.na(seeds$UP_i),"UP_i","Both_m")))
head(as.data.frame(allplants)[c(4,6,18,20)])
seeds<-merge(seeds,as.data.frame(allplants)[c(4,6,18,20)])
seeds$seeds_per_fl<-(((rowSums(seeds[,c("UP_m", "UP_i")], na.rm=T))*seeds$fr_in)+
((rowSums(seeds[,c("P_m", "P_i")], na.rm=T))*seeds$fr_pr))/seeds$n_fl
allplants_seeds<-merge(allplants,seeds[c(1:6,10)],all.x=T)
hist(allplants_seeds$seeds_per_fl)
hist(subset(allplants_seeds,seeds_per_fl<2000)$seeds_per_fl)
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
lm(suit_neigh~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants_seeds,seeds_per_fl<2000),family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants_seeds,seeds_per_fl<2000))
)
warnings()
sem.fit(sem6, data=subset(allplants_seeds,!is.na(phen)&seeds_per_fl<2000)) #p=0
sem.fit(sem6, data=subset(allplants_seeds,!is.na(phen)&seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
lm(suit_neigh~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants_seeds,seeds_per_fl<2000),family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants_seeds,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants_seeds,!is.na(phen)&seeds_per_fl<2000)) #p=0
sem.fit(sem6, data=subset(allplants_seeds,!is.na(phen)&seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
lm(suit_neigh~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants_seeds,seeds_per_fl<2000),family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants_seeds,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants_seeds,!is.na(phen)&seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=subset(allplants_seeds,!is.na(phen)&seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
lm(suit_neigh~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants_seeds,seeds_per_fl<2000),family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants_seeds,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants_seeds,!is.na(phen)&seeds_per_fl<2000)) #p=0
sem.fit(sem6, data=subset(allplants_seeds,!is.na(phen)&seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=subset(allplants_seeds,!is.na(phen)&seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
lm(suit_neigh~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants_seeds,seeds_per_fl<2000),family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants_seeds,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants_seeds,seeds_per_fl<2000)) #p=0
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
lm(suit_neigh~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants_seeds,seeds_per_fl<2000),family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants_seeds,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants_seeds,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=subset(allplants_seeds,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
lm(suit_neigh~meanT*moist_per,subset(allplants_seeds,seeds_per_fl<2000)),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants_seeds,seeds_per_fl<2000),family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants_seeds,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants_seeds,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=subset(allplants_seeds,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
rm(allplants_seeds)
allplants<-merge(allplants,seeds[c(1:6,10)],all.x=T)
head(allplants)
str(allplants)
hist(subset(allplants,seeds_per_fl<2000)$seeds_per_fl)
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,subset(allplants,seeds_per_fl<2000)),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants,seeds_per_fl<2000)),
lm(suit_neigh~meanT*moist_per,subset(allplants,seeds_per_fl<2000)),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants,seeds_per_fl<2000),family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants,seeds_per_fl<2000)) #p=0
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,subset(allplants,seeds_per_fl<2000)),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants,seeds_per_fl<2000)),
lm(suit_neigh~meanT*moist_per,subset(allplants,seeds_per_fl<2000)),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants,seeds_per_fl<2000),family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,subset(allplants,seeds_per_fl<2000)),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants,seeds_per_fl<2000)),
lm(suit_neigh~meanT*moist_per,subset(allplants,seeds_per_fl<2000)),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants,seeds_per_fl<2000),family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants,seeds_per_fl<2000)) #p=0
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,subset(allplants,seeds_per_fl<2000)),
glm.nb(Mrub_sch_s~meanT*moist_per,subset(allplants,seeds_per_fl<2000)),
lm(suit_neigh~meanT*moist_per,subset(allplants,seeds_per_fl<2000)),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants,seeds_per_fl<2000),family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants,family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants,seeds_per_fl<2000))
)
sem.fit(sem6, data=allplants) #p=0
sem.fit(sem6, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.fit(sem6, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.coefs(sem6, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.fit(sem6, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.fit(sem6, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants,family="binomial"),
glm(seeds_per_fl~phen_int+meanT*moist_per+attack,data=subset(allplants,seeds_per_fl<2000))
)
sem.fit(sem6, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.fit(sem6, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem4<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants,family="binomial"),
glm(cbind(fr_in,n_fl)~phen_int+meanT*moist_per+attack,allplants,family="binomial")
)
sem.fit(sem4, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem4)
sem.coefs(sem4, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem4<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants,family="binomial"),
glm(cbind(fr_in,n_fl)~phen_int+meanT+moist_per+attack,allplants,family="binomial")
)
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants,family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants,seeds_per_fl<2000)) #p=0
sem.fit(sem6, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants,family="binomial"),
glm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants,family="binomial"),
lm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem7<-list(#with fitness, number of eggs (only pls w eggs)
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm.nb(n_eggs_max~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants,n_eggs_max>0)),
lm(seeds_per_fl~phen_int+meanT+moist_per+n_eggs_max,data=subset(allplants,seeds_per_fl<2000&n_eggs_max>0))
)
sem.fit(sem7, data=subset(allplants,seeds_per_fl<2000)) #p=0
sem.fit(sem7, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem7)
sem.coefs(sem7, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem7<-list(#with fitness, number of eggs (only pls w eggs)
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm.nb(n_eggs_max~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,subset(allplants,n_eggs_max>0)),
lm(seeds_per_fl~phen_int+meanT+moist_per+n_eggs_max,data=subset(allplants,seeds_per_fl<2000&n_eggs_max>0))
)
sem.fit(sem7, data=subset(allplants,seeds_per_fl<2000),
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem7)
sem.coefs(sem7, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
library(data.table)
library(car)
library(MASS)
library(fmsb)
library(piecewiseSEM)
load(file="allplants.R")
#Changes needed in allplants after inspection of comments on seed data
#Some fruits noted wrong P_UP
allplants$fr_in[4486]=3
allplants$fr_inC[4486]=0
allplants$fr_pr[4486]=1
allplants$fr_prC[4486]=1
allplants$fr_in[7626]=4
allplants$fr_inC[7626]=0
allplants$fr_pr[7626]=1
allplants$fr_prC[7626]=1
allplants$suit_neigh<-allplants$pldens_3*allplants$phen_n3
hist(allplants$suit_neigh)
allplants$fruitset<-allplants$fr_in/allplants$n_fl
subset(allplants,fruitset>1) #5 cases
allplants$n_fl<-ifelse(is.na(allplants$fr_in),allplants$n_fl,ifelse(allplants$fr_in>allplants$n_fl,allplants$fr_in,allplants$n_fl))
allplants$fruitset<-ifelse(allplants$fruitset>1,1,allplants$fruitset)
seeds<-read.table("D:/SU/projects/neighbourhood_effects/data/raw/tanga2016_seeds.txt",header=T,sep="\t",dec=".")
head(seeds)
seeds<-subset(seeds,!is.na(n_dev_seeds))
seeds <- dcast(seeds, pl_id_ALL ~ inmature+P_UP, value.var="n_dev_seeds")
head(seeds)
names(seeds)<-c("pl_id","P_m","UP_m","P_i","UP_i")
seeds$status<-ifelse(!is.na(seeds$P_i)&!is.na(seeds$UP_i),"Both_i",
ifelse(!is.na(seeds$P_i),"P_i",ifelse(!is.na(seeds$UP_i),"UP_i","Both_m")))
head(as.data.frame(allplants)[c(4,6,18,20)])
seeds<-merge(seeds,as.data.frame(allplants)[c(4,6,18,20)])
seeds$seeds_per_fl<-(((rowSums(seeds[,c("UP_m", "UP_i")], na.rm=T))*seeds$fr_in)+
((rowSums(seeds[,c("P_m", "P_i")], na.rm=T))*seeds$fr_pr))/seeds$n_fl
allplants<-merge(allplants,seeds[c(1:6,10)],all.x=T)
hist(allplants$seeds_per_fl)
hist(log(allplants$seeds_per_fl))
hist(log(allplants$seeds_per_fl+1))
hist(log(allplants$seeds_per_fl+100))
hist(log(allplants$seeds_per_fl+1000))
hist(log(allplants$seeds_per_fl+500))
hist(allplants$seeds_per_fl)
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants,family="binomial"),
lm(seeds_per_fl~phen_int+meanT+moist_per+attack,data=subset(allplants,seeds_per_fl<2000))
)
sem.fit(sem6, data=subset(allplants,seeds_per_fl<2000)) #p=0
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants,family="binomial"),
lm(seeds_per_fl~phen_int+meanT+moist_per+attack,allplants)
)
sem.fit(sem6, data=allplants) #p=0
sem6<-list(#with fitness, attack
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm(attack~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants,family="binomial"),
lm(seeds_per_fl~phen_int+meanT+moist_per+attack,allplants)
)
sem.fit(sem6, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem6)
sem.coefs(sem6, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem7<-list(#with fitness, number of eggs (only pls w eggs)
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm.nb(n_eggs_max~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants),
lm(seeds_per_fl~phen_int+meanT+moist_per+n_eggs_max,allplants)
)
sem.fit(sem7, data=allplants) #p=0
sem7<-list(#with fitness, number of eggs (only pls w eggs)
lm(phen_int~meanT*moist_per,allplants),
glm.nb(Mrub_sch_s~meanT*moist_per,allplants),
lm(suit_neigh~meanT*moist_per,allplants),
glm.nb(n_eggs_max~phen_int*Mrub_sch_s+suit_neigh+meanT+moist_per,allplants),
lm(seeds_per_fl~phen_int+meanT+moist_per+n_eggs_max,allplants)
)
sem.fit(sem7, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
sem.model.fits(sem7)
sem.coefs(sem7, data=allplants,
corr.errors=c("phen_int~~Mrub_sch_s","phen_int~~suit_neigh","suit_neigh~~Mrub_sch_s"))
detectCores()
