geom_smooth(aes(n_eggs_max, seeds_per_fl),method="loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method="rlm",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method="glm",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method="glm",method.args=c(family="poisson"),se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
warnings()
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method="glm",method.args=c(family="gamma"),se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method="nls",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method="nls", formula = 'y ~ a*x^2 + b*x +c',
start=list(a=.1,b=.5,c=.2),se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method="nls", formula = "y ~ a*x^2 + b*x +c",start=list(a=.1,b=.5,c=.2),se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method="nls", formula = "y ~poly(x,2)",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(method = "lm", formula = y ~ x + I(x^2), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(n_eggs_max, seeds_per_fl,method = "lm", formula = y ~ x + I(x^2), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "lm", formula = y ~ x + I(x^2), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "gam", formula = y ~ s(x), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "gam", formula = y ~ s(x, k = 3), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "gam", formula = y ~ s(x, k = 1), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "gam", formula = y ~ s(x, k =2), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "gam", formula = y ~ s(x, k =4), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "gam", formula = y ~ s(x, k =10), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "gam", formula = y ~ s(x, k =5), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "gam", formula = y ~ s(x, k =3), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "gam", formula = y ~ s(x, k =4), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "gam", formula = y ~ s(x, k =5), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "gam", formula = y ~ s(x, k =6), size = 1)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "gam",
formula = y ~ s(x, bs = "ad"),se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "glm",
family = gaussian(link="log"),se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "glm",method.args=c(family = gaussian(link="log")),se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(0,NA))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+coord_cartesian(ylim=c(0,1000))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+coord_cartesian(ylim=c(0,1000))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(0,NA))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(-200,NA))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(-200,NA))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(-500,NA))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(-200,NA))+coord_cartesian(ylim=c(0,1000))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(-200,NA))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(0,NA))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(-150,NA))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(-200,NA))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(-200,NA))+scale_x_continuous(breaks=c(0,250,500,750,1000))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(-200,NA))+scale_y_continuous(breaks=c(0,250,500,750,1000))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(-200,NA),breaks=c(0,250,500,750,1000))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(0,NA))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
stat_smooth(aes(n_eggs_max, seeds_per_fl),method = "loess",se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(-200,NA),breaks=c(0,250,500,750,1000))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+coord_cartesian(ylim=c(0,1000))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+scale_y_continuous(limit=c(0,NA))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+coord_cartesian(ylim=c(0,1000))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+coord_cartesian(ylim=c(0,1000))
ggplot(as.data.frame(allplants)) +
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+coord_cartesian(ylim=c(0,500))
png(filename = "seeds-eggs_allplants_nopoints.png",
width = 10, height = 10, units = "cm", pointsize = 20,
bg = "white", res = 600, family = "", restoreConsole = TRUE,
type = c("windows", "cairo", "cairo-png"))
ggplot(as.data.frame(allplants)) +
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+coord_cartesian(ylim=c(0,500))
ggplot(subset(as.data.frame(allplants),n_eggs_max>0)) +
geom_point(data=subset(as.data.frame(allplants),n_eggs_max>0),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(subset(as.data.frame(allplants),n_eggs_max>0)) +
geom_point(data=subset(as.data.frame(allplants),n_eggs_max>0),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(subset(as.data.frame(allplants),n_eggs_max>0)) +
geom_point(data=subset(as.data.frame(allplants),n_eggs_max>0),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(subset(as.data.frame(allplants),n_eggs_max>0)) +
geom_point(data=subset(as.data.frame(allplants),n_eggs_max>0),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(subset(as.data.frame(allplants),n_eggs_max>0)) +
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
dev.off()
dev.off()
ggplot(as.data.frame(allplants)) +
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+coord_cartesian(ylim=c(0,500))
png(filename = "seeds-eggs_allplants_nopoints.png",
width = 10, height = 10, units = "cm", pointsize = 20,
bg = "white", res = 600, family = "", restoreConsole = TRUE,
type = c("windows", "cairo", "cairo-png"))
ggplot(as.data.frame(allplants)) +
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+coord_cartesian(ylim=c(0,500))
dev.off()
ggplot(subset(as.data.frame(allplants),n_eggs_max>0)) +
geom_point(data=subset(as.data.frame(allplants),n_eggs_max>0),aes(n_eggs_max, seeds_per_fl))+
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(subset(as.data.frame(allplants),n_eggs_max>0)) +
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")
ggplot(subset(as.data.frame(allplants),n_eggs_max>0)) +
geom_smooth(aes(n_eggs_max, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Number of eggs")+ylab("Number of seeds per flower")+coord_cartesian(ylim=c(0,400))
ggplot(as.data.frame(allplants)) +
geom_point(data=as.data.frame(allplants),aes(phen_int, seeds_per_fl))+
geom_smooth(aes(phen_int, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Shoot phenology")+ylab("Number of seeds per flower")
ggplot(as.data.frame(allplants)) +
geom_smooth(aes(phen_int, seeds_per_fl),method=lm,se=T,color="black")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme_base()+ theme(legend.position="none")+
xlab("Shoot phenology")+ylab("Number of seeds per flower")
sem10
library(piecewiseSEM)
#Models
#after model selction (in 4_7)
#Model attack####
model10_1<-lm(phen_int~PC1+PC2,as.data.frame(allplants))
model10_2<-glm(Mrub_sch_s_pres~PC1+PC2,as.data.frame(allplants),family="binomial")
model10_3<-lm(suit_neigh~PC1+PC2,as.data.frame(allplants))
model10_4<-glm(attack_f~phen_int+Mrub_sch_s_pres+phen_int:Mrub_sch_s_pres+suit_neigh+PC1+PC2,as.data.frame(allplants),family="binomial")
model10_5<-lm(seeds_per_fl~phen_int+attack_f,as.data.frame(allplants)) #Removed PC1+PC2
sem10<-list(#with fitness, attack
model10_1,
model10_2,
model10_3,
model10_4,
model10_5
)
sem.fit(sem10, data=as.data.frame(allplants)) #p=0.065
sem.model.fits(sem10)
sem.coefs(sem10, data=as.data.frame(allplants),standardize="scale")
model10_4
model10_4_res_nei_env<-glm(attack_f~phen_int+Mrub_sch_s_pres+phen_int:Mrub_sch_s_pres+suit_neigh+PC1+PC2,as.data.frame(allplants),family="binomial")
model10_4_res<-glm(attack_f~phen_int+Mrub_sch_s_pres+phen_int:Mrub_sch_s_pres,as.data.frame(allplants),family="binomial")
model10_4_nei<-glm(attack_f~suit_neigh,as.data.frame(allplants),family="binomial")
model10_4_env<-glm(attack_f~PC1+PC2,as.data.frame(allplants),family="binomial")
model10_4_res_nei<-glm(attack_f~phen_int+Mrub_sch_s_pres+phen_int:Mrub_sch_s_pres+suit_neigh,as.data.frame(allplants),family="binomial")
model10_4_res_env<-glm(attack_f~phen_int+Mrub_sch_s_pres+phen_int:Mrub_sch_s_pres+PC1+PC2,as.data.frame(allplants),family="binomial")
model10_4_nei_env<-glm(attack_f~suit_neigh+PC1+PC2,as.data.frame(allplants),family="binomial")
model10_4
summary(model10_4)
sem.model.fits(sem10)
?sem.model.fits
sem.model.fits(model10_4)
str(sem.model.fits(model10_4))
sem.model.fits(model10_4)$R.squared
R_res_nei_env<-sem.model.fits(model10_4_res_nei_env)$R.squared
R_res_nei_env
R_res_nei_env<-sem.model.fits(model10_4_res_nei_env)$R.squared
R_res<-sem.model.fits(model10_4_res)$R.squared
R_nei<-sem.model.fits(model10_4_nei)$R.squared
R_env<-sem.model.fits(model10_4_env)$R.squared
R_res_nei<-sem.model.fits(model10_4_res_nei)$R.squared
R_res_env<-sem.model.fits(model10_4_res_env)$R.squared
R_nei_env<-sem.model.fits(model10_4_nei_env)$R.squared
res<-R_res_nei_env-R_nei_env
nei<-R_res_nei_env-R_res_env
env<-R_res_nei_env-R_res_nei
res_nei<-R_res_nei_env-R_env-res-nei
res_env<-R_res_nei_env-R_nei-res-env
nei_env<-R_res_nei_env-R_res-nei-env
res_nei_env<-R_res_nei_env-res-nei-env-res_nei-res_env-nei_env
R_res_nei_env
res+nei+env+res_nei+res_env+nei_env+res_nei_env
(res/R_res_nei_env)*100
(nei/R_res_nei_env)*100
(env/R_res_nei_env)*100
(res_nei/R_res_nei_env)*100
(res_env/R_res_nei_env)*100
(nei_env/R_res_nei_env)*100
(res_nei_env/R_res_nei_env)*100
model10_5_phe_att<-lm(seeds_per_fl~phen_int+attack_f,as.data.frame(allplants))
model10_5_phe<-lm(seeds_per_fl~phen_int,as.data.frame(allplants))
model10_5_att<-lm(seeds_per_fl~attack_f,as.data.frame(allplants))
R_phe_att<-sem.model.fits(model10_5_phe_att)$R.squared
R_phe_att
R_phe<-sem.model.fits(model10_5_phe)$R.squared
R_att<-sem.model.fits(model10_5_att)$R.squared
phe<-R_phe_att-R_att
att<-R_phe_att-R_phe
phe_att<-R_phe_att-phe-att
(phe/R_phe_att)*100
(att/R_phe_att)*100
(phe_att/R_phe_att)*100
phe+att+phe_att
#model seeds with env
model10_5_alt<-lm(seeds_per_fl~phen_int+attack_f+PC1+PC2,as.data.frame(allplants))
summary(model10_5_alt)
model10_5_alt_phe_att_env<-lm(seeds_per_fl~phen_int+attack_f+PC1+PC2,as.data.frame(allplants))
model10_5_alt_phe<-lm(seeds_per_fl~phen_int,as.data.frame(allplants))
model10_5_alt_att<-lm(seeds_per_fl~attack_f,as.data.frame(allplants))
model10_5_alt_env<-lm(seeds_per_fl~PC1+PC2,as.data.frame(allplants))
model10_5_alt_phe_att<-lm(seeds_per_fl~phen_int+attack_f,as.data.frame(allplants))
model10_5_alt_phe_env<-lm(seeds_per_fl~phen_int+PC1+PC2,as.data.frame(allplants))
model10_5_alt_att_env<-lm(seeds_per_fl~attack_f+PC1+PC2,as.data.frame(allplants))
R_phe_att_env<-sem.model.fits(model10_5_alt_phe_att_env)$R.squared
R_phe_att_env
R_phe<-sem.model.fits(model10_5_alt_phe)$R.squared
R_att<-sem.model.fits(model10_5_alt_att)$R.squared
R_env<-sem.model.fits(model10_5_alt_env)$R.squared
R_phe_att<-sem.model.fits(model10_5_alt_phe_att)$R.squared
R_phe_env<-sem.model.fits(model10_5_alt_phe_env)$R.squared
R_att_env<-sem.model.fits(model10_5_alt_att_env)$R.squared
phe<-R_phe_att_env-R_att_env
att<-R_phe_att_env-R_phe_env
env<-R_phe_att_env-R_phe_att
phe_att<-R_phe_att_env-R_env-phe-att
phe_env<-R_phe_att_env-R_att-phe-env
att_env<-R_phe_att_env-R_phe-att-env
phe_att_env<-R_phe_att_env-phe-att-env-phe_att-phe_env-att_env
(phe/R_phe_att_env)*100
(att/R_phe_att_env)*100
(env/R_phe_att_env)*100
(phe_att/R_phe_att_env)*100
(phe_env/R_phe_att_env)*100
(att_env/R_phe_att_env)*100
(phe_att_env/R_phe_att_env)*100
phe+att+env+phe_att+phe_env+att_env+phe_att_env
