summary(glm(attack ~scale(Mrug_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-0.07676
summary(glm.nb(n_eggs_max~scale(allM_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Mrub_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Msca_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Mrug_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Msch_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(oth_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Mrub_sch_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Mrub_rug_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Mrub_sch_rug_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
# With Mrub_sch_s (original)
model1<-glm(attack ~ scale(phen) + scale(Mrub_sch_s) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_s)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")
# With Mrub_sch_s (original)
model1<-glm(attack ~ scale(phen) + scale(Mrub_sch_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")
summary(model1)
NagelkerkeR2(model1)
head(data_plants_paper)
# With Mrub_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrub_pres
summary(glm(attack ~ scale(phen) + Mrub_pres + scale(pldens_3) +
scale(phen_n3) + scale(phen):Mrub_pres+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrub_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrub_sch_s (original)
model1<-glm(attack ~ scale(phen) + scale(Mrub_sch_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")
summary(model1)
NagelkerkeR2(model1)
# With Mrub_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrug_sum
summary(glm(attack ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Msch_sum
summary(glm(attack ~ scale(phen) + scale(Msch_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Msch_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_rug_s
summary(glm(attack ~ scale(phen) + scale(Mrub_rug_s) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_s)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_rug_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sch_rug_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sch_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_rug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_rug_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sch_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sch_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sch_rug_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sch_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_rug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrug_pres
summary(glm(attack ~ scale(phen) + scale(Mrug_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Msch_pres
summary(glm(attack ~ scale(phen) + scale(Msch_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Msch_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_rug_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_rug_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sch_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_sch_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sch_rug_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_sch_rug_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_rug_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
Anova(model2)
Anova(model3) #Interaction* - Larger prob when phen=6 & Mrug_p=0
library(car)
Anova(model2)
Anova(model3) #Interaction* - Larger prob when phen=6 & Mrug_p=0
head(data_plants_paper)
model2<-glm(attack ~ phen_factor+Mrub_sum+phen_factor:Mrub_sum,subset(data_plants_paper,!is.na(phen)),family="binomial")
# With phenology as factor
data_plants_paper$phen_factor<-as.factor(as.character(data_plants_paper$phen))
model2<-glm(attack ~ phen_factor+Mrub_sum+phen_factor:Mrub_sum,subset(data_plants_paper,!is.na(phen)),family="binomial")
summary(model2)
Anova(model2)
# With phenology as factor
data_plants_paper$phen_factor<-as.ordered(as.character(data_plants_paper$phen))
model2<-glm(attack ~ phen_factor+Mrub_sum+phen_factor:Mrub_sum,subset(data_plants_paper,!is.na(phen)),family="binomial")
Anova(model2)
summary(model2)
str(data_plants_paper)
summary(glm(attack ~ phen_factor + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + phen_factor:scale(Mrub_sum)+
phen_factor:scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
Anova(glm(attack ~ phen_factor + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + phen_factor:scale(Mrub_sum)+
phen_factor:scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
Anova(glm(attack ~ phen_factor + scale(Mrub_pres) + scale(pldens_3) +
scale(phen_n3) + phen_factor:scale(Mrub_pres)+
phen_factor:scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
class(data_plants_paper$phen)
class(data_plants_paper$phen_factor)
Anova(model3) #Interaction* - Larger prob when phen=6 & Mrug_p=0
# With Mrug_pres
summary(glm(attack ~ scale(phen) + scale(Mrug_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
summary(glm(attack ~ scale(phen) + scale(Mrug_pres) +
scale(phen):scale(Mrug_pres),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
summary(glm(attack ~ scale(phen_factor) + scale(Mrug_pres) +
scale(phen_factor):scale(Mrug_pres),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
summary(glm(attack ~ phen_factor + scale(Mrug_pres) +
phen_factor:scale(Mrug_pres),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
Anova(glm(attack ~ phen_factor + scale(Mrug_pres) +
phen_factor:scale(Mrug_pres),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
Anova(model3) #Interaction* - Larger prob when phen=6 & Mrug_p=0
model3<-glm(attack ~ phen_factor+Mrug_p+phen_factor:Mrug_p,subset(data_plants_paper,!is.na(phen)),family="binomial")
model3<-glm(attack ~ phen_factor+Mrug_pres+phen_factor:Mrug_pres,subset(data_plants_paper,!is.na(phen)),family="binomial")
Anova(model3) #Interaction* - Larger prob when phen=6 & Mrug_p=0
p
# With Mrug_pres
summary(glm(attack ~ scale(phen) + scale(Mrug_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
Anova(glm(attack ~ phen_factor + scale(Mrug_pres) +
phen_factor:scale(Mrug_pres),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
interaction1<-data.frame(effect(term="scale(phen):scale(Mrub_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrub_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),xlevels=list(Mrub_p=c(0,1), phen=1:6)))
range(data_plants_paper$Mrub_sum)
interaction1<-data.frame(effect(term="scale(phen):scale(Mrub_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrub_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),
xlevels=list(Mrub_sum=seq(0,35,1), phen=1:6)))
interaction1
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_point(aes(phen,fit,color=Mrub_sum),size=3)+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance Mrub")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
warnings()
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_point(aes(phen,fit,color=Mrub_sum),size=1)+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance Mrub")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance Mrub")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
p1
#Figures paper
interaction1<-data.frame(effect(term="scale(phen):scale(Mrub_sch_s)", mod=model1_ME,
xlevels=list(Mrub_sch_s=seq(0,35,1), phen=1:6)))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance Mrub")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
interaction1<-data.frame(effect(term="scale(phen):scale(Mrub_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrub_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),
xlevels=list(Mrub_sum=seq(0,35,0.5), phen=1:6)))
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance Mrub")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
interaction1<-data.frame(effect(term="scale(phen):scale(Mrub_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrub_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),
xlevels=list(Mrub_sum=seq(0,35,1), phen=1:6)))
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance Mrub")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Abundance Myrmica rubra")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
expression(paste("Abundance",italic("Myrmica rubra")))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance",italic("Myrmica rubra"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance ",italic("Myrmica rubra"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
range(data_plants_paper$Mrug_sum)
range(data_plants_paper$Mrub_sum)
interaction1<-data.frame(effect(term="scale(phen):scale(Mrub_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrub_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),
xlevels=list(Mrub_sum=seq(0,34,1), phen=1:6)))
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance ",italic("Myrmica rubra"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
interaction2<-data.frame(effect(term="scale(phen):scale(Mrug_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrug_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),
xlevels=list(Mrug_sum=seq(0,46,1), phen=1:6)))
ggplot(interaction2, aes(phen,fit, group = as.factor(Mrug_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrug_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance ",italic("Myrmica ruginodis"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
# With Mrub_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrug_sum
summary(glm(attack ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
#Load packages
library(MASS)
library(fmsb)
library(spdep)
library(rasterVis)
library(ncf)
library(maptools)
library(gstat)
library(ggplot2)
library(ggthemes)
library(effects)
library(cowplot)
library(car)
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance ",italic("Myrmica rubra"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(interaction2, aes(phen,fit, group = as.factor(Mrug_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrug_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance ",italic("Myrmica ruginodis"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
summary(model1)
# With Mrub_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrug_sum
summary(glm(attack ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_rug_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
head(data_plants_paper)
#Negative binomial GLM relating the number of eggs in shoots with at least one egg to shoot phenology, ant abundance,
#neighbor density and neighbor phenology, and to three different two-way interactions of these predictors (Table 1B)
model2<-glm.nb(n_eggs_max ~ scale(phen) + scale(Mrub_sch_s) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_s) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))
summary(model2)
NagelkerkeR2(model2)
#Negative binomial GLM relating the number of eggs in shoots with at least one egg to shoot phenology, ant abundance,
#neighbor density and neighbor phenology, and to three different two-way interactions of these predictors (Table 1B)
model2<-glm.nb(n_eggs_max ~ scale(phen) + scale(Mrub_sch_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))
summary(model2)
NagelkerkeR2(model2)
head(data_plants_paper)
summary(glm.nb(n_eggs_max ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)&n_eggs_max>0)))
summary(glm.nb(n_eggs_max ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen))))
summary(glm.nb(n_eggs_max ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)&n_eggs_max>0)))
summary(glm.nb(n_eggs_max ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen))))
summary(glm.nb(n_eggs_max ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)&n_eggs_max>0)))
summary(glm.nb(n_eggs_max ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen))))
nrow(subset(data_plants_paper,Mrug_sum>0))
nrow(subset(data_plants_paper))
(7346/8852)*100
nrow(subset(data_plants_paper,Mrug_sum>0&n_eggs_max==0))
nrow(subset(data_plants_paper,Mrug_sum>0&n_eggs_max>0))
nrow(subset(data_plants_paper,Mrug_sum==0&n_eggs_max>0))
# With Mrub_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sch_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_sch_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS (marg)
# With Mrub_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrug_sum
summary(glm(attack ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_rug_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
range(data_plants_paper$Mrub_rug_sum)
interaction3<-data.frame(effect(term="scale(phen):scale(Mrub_rug_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrub_rug_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),
xlevels=list(Mrub_rug_sum=seq(0,46,1), phen=1:6)))
ggplot(interaction3, aes(phen,fit, group = as.factor(Mrub_rug_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_rug_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance ",italic("Myrmica rubra + ruginodis"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
warnings()
interaction3
# With Mrug_sum
summary(glm(attack ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
head(data_plants_paper)
plot(phen,attack)
with(data_plants_paper,plot(phen,attack))
plot(data_plants_paper$phen,data_plants_paper$attack)
str(data_plants_paper)
plot(as.factor(data_plants_paper$phen),data_plants_paper$attack)
plot(as.character(data_plants_paper$phen),data_plants_paper$attack)
)plot(data_plants_paper$phen,as.factor(data_plants_paper$attack)
plot(data_plants_paper$phen,as.factor(data_plants_paper$attack))
plot(as.factor(data_plants_paper$phen),as.factor(data_plants_paper$attack))
plot(as.character(data_plants_paper$phen),as.character(data_plants_paper$attack))
plot(as.factor(data_plants_paper$phen),as.factor(data_plants_paper$attack))
library(ggplot2)
library(ggthemes)
ggplot(data_plants_paper,aes(x=as.factor(phen),y=as.factor(attack))) + geom_bar(stat = "identity")
ggplot(as.data.frame(data_plants_paper),aes(x=as.factor(phen),y=as.factor(attack))) + geom_bar(stat = "identity")
ggplot(as.data.frame(data_plants_paper),aes(x=as.factor(phen),y=attack)) + geom_bar(stat = "identity")
ggplot(as.data.frame(data_plants_paper),aes(x=as.factor(phen),y=as.factor(attack))) + geom_bar()
plot(as.factor(data_plants_paper$phen),as.factor(data_plants_paper$attack))
?plot
plot(as.factor(data_plants_paper$phen),as.factor(data_plants_paper$attack),xlab="Phenology",ylab="Attack")
plot(as.factor(data_plants_paper$phen),as.factor(data_plants_paper$attack),xlab="Phenology",ylab="Attack")
plot(as.factor(data_plants_paper$phen),data_plants_paper$attack,xlab="Phenology",ylab="Attack")
plot(as.factor(data_plants_paper$phen),as.integer(data_plants_paper$attack),xlab="Phenology",ylab="Attack")
plot(as.factor(data_plants_paper$phen),as.factor(data_plants_paper$attack),xlab="Phenology",ylab="Attack")
plot(data_plants_paper$phen,as.factor(data_plants_paper$attack),xlab="Phenology",ylab="Attack")
plot(as.factor(data_plants_paper$phen),as.factor(data_plants_paper$attack),xlab="Phenology",ylab="Attack")
plot(as.factor(data_plants_paper$phen),data_plants_paper$n_eggs_max,xlab="Phenology",ylab="Attack")
?boxplot
boxplot(formula=n_eggs_max~as.factor(phen),data_plants_paper)
boxplot(formula=n_eggs_max~as.factor(phen),as.data.frame(data_plants_paper))
boxplot(formula=n_eggs_max~as.factor(phen),data=as.data.frame(data_plants_paper))
boxplot(formula=n_eggs_max~as.factor(phen),data=as.data.frame(data_plants_paper),notch=T)
boxplot(formula=n_eggs_max~as.factor(phen),data=as.data.frame(data_plants_paper),notch=T,outline=F)
boxplot(formula=n_eggs_max~as.factor(phen),data=as.data.frame(data_plants_paper),outline=F)
boxplot(formula=n_eggs_max~as.factor(phen),data=as.data.frame(subset(data_plants_paper,n_eggs_max>0)),outline=F)
plot(as.factor(data_plants_paper$phen),data_plants_paper$n_eggs_max,xlab="Phenology",ylab="Attack")
plot(as.factor(data_plants_paper$phen),as.factor(data_plants_paper$attack),xlab="Phenology",ylab="Attack")
plot(as.factor(data_plants_paper$phen),as.factor(data_plants_paper$attack),xlab="Phenology",ylab="Attack")
with(data_plants_paper,cor(phen,Mrub_sum))
with(as.fata.frame(data_plants_paper),cor(phen,Mrub_sum))
with(as.data.frame(data_plants_paper),cor(phen,Mrub_sum))
with(as.data.frame(data_plants_paper),cor(phen,Mrub_sum,na.rm=T))
?cor
with(as.data.frame(data_plants_paper),cor(phen,Mrub_sum,use="everything"))
with(as.data.frame(data_plants_paper),cor(phen,Mrub_sum,use="all.obs"))
with(as.data.frame(data_plants_paper),cor(phen,Mrub_sum,use="complete.obs"))
with(as.data.frame(data_plants_paper),cor(phen,Mrub_sum,use="na.or.complete"))
with(as.data.frame(data_plants_paper),cor(phen,Mrub_sum,use="pairwise.complete.obs"))
with(as.data.frame(data_plants_paper),cor(phen,Mrub_sum,use="complete.obs"))
with(as.data.frame(data_plants_paper),cor(phen,Mrub_sum,use="complete.obs"))
with(as.data.frame(data_plants_paper),cor(phen,Mrug_sum,use="complete.obs"))
with(as.data.frame(data_plants_paper),cor(phen,Mrub_rug_sum,use="complete.obs"))
with(as.data.frame(data_plants_paper),cor(phen,Msch_sum,use="complete.obs"))
with(as.data.frame(data_plants_paper),cor(phen,Msca_sum,use="complete.obs"))
str(data_plants_paper)
with(as.data.frame(data_plants_paper),cor(as.numeric(phen),Mrub_sum,use="complete.obs"))
with(as.data.frame(data_plants_paper),cor(phen,Mrub_sum,use="complete.obs"))
with(as.data.frame(data_plants_paper),cor(as.numeric(phen),allM_sum,use="complete.obs"))
ME.model1
model1_ME<-glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3)+
scale(vector2),
subset(data_plants_paper,!is.na(phen)),family="binomial")
summary(model1_ME)
model1_ME<-glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3)+
scale(vector2)+scale(vector1),
subset(data_plants_paper,!is.na(phen)),family="binomial")
summary(model1_ME)
ME.model1
ME.model1
summary(glm(attack ~scale(phen)*scale(Mrub_sum), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.17423
summary(glm(attack ~scale(phen)*scale(Mrub_sum)+scale(phen_n3)*scale(pldens_3), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.17423
head(data_ants_paper)
head(data_pts)
head(ants_T)
ants_T<-read.table("D:/SU/projects/neighbourhood_effects/data/raw/tanga2016_ants.txt",header=T,sep="\t",dec=".")
head(ants_T)
head(allplants)
load(file="allplants.R")
head(data_plants_paper)
