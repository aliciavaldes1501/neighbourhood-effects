par(mfrow=c(3,3))
hist(data_plants_paper$Mrub_sum)
hist(data_plants_paper$Mrub_rug_sum)
hist(data_plants_paper$allM_sum)
hist(data_plants_paper$Mrub_pres)
hist(data_plants_paper$Mrub_rug_pres)
hist(data_plants_paper$allM_pres)
par(mfrow=c(2,2))
hist(data_plants_paper$Mrub_sum)
hist(data_plants_paper$Mrub_rug_sum)
hist(data_plants_paper$allM_sum)
hist(data_plants_paper$Mrub_pres)
par(mfrow=c(2,4))
hist(data_plants_paper$Mrub_sum)
hist(data_plants_paper$Mrub_rug_sum)
hist(data_plants_paper$allM_sum)
hist(data_plants_paper$Mrub_pres)
par(mfrow=c(2,3))
hist(data_plants_paper$Mrub_sum)
hist(data_plants_paper$Mrub_rug_sum)
hist(data_plants_paper$allM_sum)
hist(data_plants_paper$Mrub_pres)
hist(data_plants_paper$Mrub_rug_pres)
hist(data_plants_paper$allM_pres)
par(mfrow=c(3,2))
hist(data_plants_paper$Mrub_sum)
hist(data_plants_paper$Mrub_rug_sum)
hist(data_plants_paper$allM_sum)
hist(data_plants_paper$Mrub_rug_pres)
hist(data_plants_paper$Mrub_pres)
hist(data_plants_paper$allM_pres)
dev.off()
par(mfrow=c(2,3))
hist(data_plants_paper$Mrub_sum)
hist(data_plants_paper$Mrub_rug_sum)
hist(data_plants_paper$allM_sum)
hist(data_plants_paper$Mrub_pres)
hist(data_plants_paper$Mrub_rug_pres)
hist(data_plants_paper$allM_pres)
par(mfrow=c(1,1))
#Mrub_pres,Mrug_pres,Msch_pres are PROBABILITIES OF PRESENCE
dev.off()
par(mfrow=c(3,2))
hist(data_plants_paper$Mrub_sum)
hist(data_plants_paper$Mrub_rug_sum)
hist(data_plants_paper$allM_sum)
hist(data_plants_paper$Mrub_pres)
hist(data_plants_paper$Mrub_rug_pres)
hist(data_plants_paper$allM_pres)
par(mfrow=c(1,1))
#Mrub_pres,Mrug_pres,Msch_pres are PROBABILITIES OF PRESENCE
head(data_plants_paper)
str(data_plants_paper)
#Calculation of the probability  of a shoot having at least one egg  (0/1)
data_plants_paper$attack<-ifelse(data_plants_paper$n_eggs_max>0,1,0)
#Univariate GLMs relating the probability of having eggs to the abundance of different ant species (Table S1A)
summary(glm(attack ~scale(allM_sum), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-0.52232
summary(glm(attack ~scale(Mrub_sum), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.17423
summary(glm(attack ~scale(Msca_sum), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-1.36392
summary(glm(attack ~scale(Mrug_sum), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-0.21499
summary(glm(attack ~scale(Msch_sum), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.35843
summary(glm(attack ~scale(oth_sum), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-0.40260
summary(glm(attack ~scale(Mrub_rug_sum), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-0.10148
summary(glm(attack ~scale(Mrub_sch_sum), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.36009
summary(glm(attack ~scale(Mrub_sch_rug_sum), subset(data_plants_paper,!is.na(phen)),family="binomial")) #NS
summary(glm(attack ~scale(allM_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #
summary(glm(attack ~scale(Mrub_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.15829
summary(glm(attack ~scale(Msca_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #
summary(glm(attack ~scale(Mrug_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-0.07676
summary(glm(attack ~scale(Msch_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.41683
summary(glm(attack ~scale(oth_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #
summary(glm(attack ~scale(oth_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-0.35627
summary(glm(attack ~scale(Mrub_rug_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.16343
summary(glm(attack ~scale(Mrub_sch_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.45511
summary(glm(attack ~scale(Mrub_sch_rug_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.48664
summary(glm(attack ~scale(allM_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-0.31957
summary(glm(attack ~scale(Mrub_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.15829
summary(glm(attack ~scale(Msca_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-0.88150
summary(glm(attack ~scale(Mrug_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-0.07676
summary(glm(attack ~scale(Msch_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.41683
summary(glm(attack ~scale(oth_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-0.35627
summary(glm(attack ~scale(Mrub_rug_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.16343
summary(glm(attack ~scale(Mrub_sch_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.45511
summary(glm(attack ~scale(Mrub_sch_rug_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #0.48664
summary(glm(attack ~scale(Mrug_pres), subset(data_plants_paper,!is.na(phen)),family="binomial")) #-0.07676
summary(glm.nb(n_eggs_max~scale(allM_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Mrub_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Msca_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Mrug_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Msch_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(oth_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Mrub_sch_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Mrub_rug_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
summary(glm.nb(n_eggs_max~scale(Mrub_sch_rug_pres), subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))) #NS
# With Mrub_sch_s (original)
model1<-glm(attack ~ scale(phen) + scale(Mrub_sch_s) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_s)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")
# With Mrub_sch_s (original)
model1<-glm(attack ~ scale(phen) + scale(Mrub_sch_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")
summary(model1)
NagelkerkeR2(model1)
head(data_plants_paper)
# With Mrub_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrub_pres
summary(glm(attack ~ scale(phen) + Mrub_pres + scale(pldens_3) +
scale(phen_n3) + scale(phen):Mrub_pres+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrub_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrub_sch_s (original)
model1<-glm(attack ~ scale(phen) + scale(Mrub_sch_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")
summary(model1)
NagelkerkeR2(model1)
# With Mrub_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrug_sum
summary(glm(attack ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Msch_sum
summary(glm(attack ~ scale(phen) + scale(Msch_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Msch_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_rug_s
summary(glm(attack ~ scale(phen) + scale(Mrub_rug_s) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_s)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_rug_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sch_rug_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sch_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_rug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_rug_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sch_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sch_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sch_rug_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sch_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_rug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrug_pres
summary(glm(attack ~ scale(phen) + scale(Mrug_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Msch_pres
summary(glm(attack ~ scale(phen) + scale(Msch_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Msch_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_rug_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_rug_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sch_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_sch_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sch_rug_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_sch_rug_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_rug_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
Anova(model2)
Anova(model3) #Interaction* - Larger prob when phen=6 & Mrug_p=0
library(car)
Anova(model2)
Anova(model3) #Interaction* - Larger prob when phen=6 & Mrug_p=0
head(data_plants_paper)
model2<-glm(attack ~ phen_factor+Mrub_sum+phen_factor:Mrub_sum,subset(data_plants_paper,!is.na(phen)),family="binomial")
# With phenology as factor
data_plants_paper$phen_factor<-as.factor(as.character(data_plants_paper$phen))
model2<-glm(attack ~ phen_factor+Mrub_sum+phen_factor:Mrub_sum,subset(data_plants_paper,!is.na(phen)),family="binomial")
summary(model2)
Anova(model2)
# With phenology as factor
data_plants_paper$phen_factor<-as.ordered(as.character(data_plants_paper$phen))
model2<-glm(attack ~ phen_factor+Mrub_sum+phen_factor:Mrub_sum,subset(data_plants_paper,!is.na(phen)),family="binomial")
Anova(model2)
summary(model2)
str(data_plants_paper)
summary(glm(attack ~ phen_factor + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + phen_factor:scale(Mrub_sum)+
phen_factor:scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
Anova(glm(attack ~ phen_factor + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + phen_factor:scale(Mrub_sum)+
phen_factor:scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
Anova(glm(attack ~ phen_factor + scale(Mrub_pres) + scale(pldens_3) +
scale(phen_n3) + phen_factor:scale(Mrub_pres)+
phen_factor:scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
class(data_plants_paper$phen)
class(data_plants_paper$phen_factor)
Anova(model3) #Interaction* - Larger prob when phen=6 & Mrug_p=0
# With Mrug_pres
summary(glm(attack ~ scale(phen) + scale(Mrug_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
summary(glm(attack ~ scale(phen) + scale(Mrug_pres) +
scale(phen):scale(Mrug_pres),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
summary(glm(attack ~ scale(phen_factor) + scale(Mrug_pres) +
scale(phen_factor):scale(Mrug_pres),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
summary(glm(attack ~ phen_factor + scale(Mrug_pres) +
phen_factor:scale(Mrug_pres),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
Anova(glm(attack ~ phen_factor + scale(Mrug_pres) +
phen_factor:scale(Mrug_pres),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
Anova(model3) #Interaction* - Larger prob when phen=6 & Mrug_p=0
model3<-glm(attack ~ phen_factor+Mrug_p+phen_factor:Mrug_p,subset(data_plants_paper,!is.na(phen)),family="binomial")
model3<-glm(attack ~ phen_factor+Mrug_pres+phen_factor:Mrug_pres,subset(data_plants_paper,!is.na(phen)),family="binomial")
Anova(model3) #Interaction* - Larger prob when phen=6 & Mrug_p=0
p
# With Mrug_pres
summary(glm(attack ~ scale(phen) + scale(Mrug_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
Anova(glm(attack ~ phen_factor + scale(Mrug_pres) +
phen_factor:scale(Mrug_pres),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
interaction1<-data.frame(effect(term="scale(phen):scale(Mrub_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrub_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),xlevels=list(Mrub_p=c(0,1), phen=1:6)))
range(data_plants_paper$Mrub_sum)
interaction1<-data.frame(effect(term="scale(phen):scale(Mrub_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrub_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),
xlevels=list(Mrub_sum=seq(0,35,1), phen=1:6)))
interaction1
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_point(aes(phen,fit,color=Mrub_sum),size=3)+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance Mrub")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
warnings()
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_point(aes(phen,fit,color=Mrub_sum),size=1)+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance Mrub")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance Mrub")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
p1
#Figures paper
interaction1<-data.frame(effect(term="scale(phen):scale(Mrub_sch_s)", mod=model1_ME,
xlevels=list(Mrub_sch_s=seq(0,35,1), phen=1:6)))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance Mrub")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
interaction1<-data.frame(effect(term="scale(phen):scale(Mrub_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrub_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),
xlevels=list(Mrub_sum=seq(0,35,0.5), phen=1:6)))
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance Mrub")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
interaction1<-data.frame(effect(term="scale(phen):scale(Mrub_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrub_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),
xlevels=list(Mrub_sum=seq(0,35,1), phen=1:6)))
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance Mrub")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Abundance Myrmica rubra")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
expression(paste("Abundance",italic("Myrmica rubra")))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance",italic("Myrmica rubra"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance ",italic("Myrmica rubra"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
range(data_plants_paper$Mrug_sum)
range(data_plants_paper$Mrub_sum)
interaction1<-data.frame(effect(term="scale(phen):scale(Mrub_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrub_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),
xlevels=list(Mrub_sum=seq(0,34,1), phen=1:6)))
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance ",italic("Myrmica rubra"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
interaction2<-data.frame(effect(term="scale(phen):scale(Mrug_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrug_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),
xlevels=list(Mrug_sum=seq(0,46,1), phen=1:6)))
ggplot(interaction2, aes(phen,fit, group = as.factor(Mrug_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrug_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance ",italic("Myrmica ruginodis"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
# With Mrub_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrug_sum
summary(glm(attack ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
#Load packages
library(MASS)
library(fmsb)
library(spdep)
library(rasterVis)
library(ncf)
library(maptools)
library(gstat)
library(ggplot2)
library(ggthemes)
library(effects)
library(cowplot)
library(car)
ggplot(interaction1, aes(phen,fit, group = as.factor(Mrub_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance ",italic("Myrmica rubra"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(interaction2, aes(phen,fit, group = as.factor(Mrug_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrug_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance ",italic("Myrmica ruginodis"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
summary(model1)
# With Mrub_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrug_sum
summary(glm(attack ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_rug_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
head(data_plants_paper)
#Negative binomial GLM relating the number of eggs in shoots with at least one egg to shoot phenology, ant abundance,
#neighbor density and neighbor phenology, and to three different two-way interactions of these predictors (Table 1B)
model2<-glm.nb(n_eggs_max ~ scale(phen) + scale(Mrub_sch_s) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_s) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))
summary(model2)
NagelkerkeR2(model2)
#Negative binomial GLM relating the number of eggs in shoots with at least one egg to shoot phenology, ant abundance,
#neighbor density and neighbor phenology, and to three different two-way interactions of these predictors (Table 1B)
model2<-glm.nb(n_eggs_max ~ scale(phen) + scale(Mrub_sch_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)&n_eggs_max>0))
summary(model2)
NagelkerkeR2(model2)
head(data_plants_paper)
summary(glm.nb(n_eggs_max ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)&n_eggs_max>0)))
summary(glm.nb(n_eggs_max ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen))))
summary(glm.nb(n_eggs_max ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)&n_eggs_max>0)))
summary(glm.nb(n_eggs_max ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen))))
summary(glm.nb(n_eggs_max ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)&n_eggs_max>0)))
summary(glm.nb(n_eggs_max ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_sum) +
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen))))
nrow(subset(data_plants_paper,Mrug_sum>0))
nrow(subset(data_plants_paper))
(7346/8852)*100
nrow(subset(data_plants_paper,Mrug_sum>0&n_eggs_max==0))
nrow(subset(data_plants_paper,Mrug_sum>0&n_eggs_max>0))
nrow(subset(data_plants_paper,Mrug_sum==0&n_eggs_max>0))
# With Mrub_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_sch_pres
summary(glm(attack ~ scale(phen) + scale(Mrub_sch_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sch_pres)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS (marg)
# With Mrub_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction*
# With Mrug_sum
summary(glm(attack ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
# With Mrub_rug_sum
summary(glm(attack ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrub_rug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
range(data_plants_paper$Mrub_rug_sum)
interaction3<-data.frame(effect(term="scale(phen):scale(Mrub_rug_sum)",
mod=glm(attack ~ scale(phen) + scale(Mrub_rug_sum) + scale(pldens_3) + scale(phen_n3) +
scale(phen):scale(Mrub_rug_sum)+scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial"),
xlevels=list(Mrub_rug_sum=seq(0,46,1), phen=1:6)))
ggplot(interaction3, aes(phen,fit, group = as.factor(Mrub_rug_sum)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen,fit,color=Mrub_rug_sum))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour=expression(paste("Abundance ",italic("Myrmica rubra + ruginodis"))))+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
warnings()
interaction3
# With Mrug_sum
summary(glm(attack ~ scale(phen) + scale(Mrug_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen):scale(Mrug_sum)+
scale(phen):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(data_plants_paper,!is.na(phen)),family="binomial")) # Interaction NS
