summary(glm.nb(n_eggs_max~scale(Msch_pres),allplants))
summary(glm.nb(n_eggs_max~scale(Mrub_sum),allplants))
summary(glm.nb(n_eggs_max~scale(Msch_sum),allplants))
AIC(glm.nb(n_eggs_max~scale(Mrub_sum),allplants))
AIC(glm.nb(n_eggs_max~scale(Msch_sum),allplants))
head(allplants)
subset(allplants, pldens_05==0)
subset(allplants, pldens_1==0)
NagelkerkeR2(mod2)
NagelkerkeR2(mod2aut)
NagelkerkeR2(mod1)
summary(mod1)
NagelkerkeR2(mod2)
mod1<-glm.nb(n_eggs_max~(scale(as.integer(phen))+scale(meanTday)+scale(moist_per)+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2))^2,allplants)
summary(mod1)
NagelkerkeR2(mod1)
mod1<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(meanTday)+scale(moist_per)+scale(Mrub_sum)+scale(pldens_1)+scale(phen_n1),allplants)
summary(mod1)
NagelkerkeR2(mod2)
mod1<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(meanTday)+scale(moist_per)+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2),allplants)
summary(mod1)
NagelkerkeR2(mod1)
mod2<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(meanTday)+scale(moist_per)+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2),subset(allplants,!is.na(pl_id)))
summary(mod2)
NagelkerkeR2(mod2)
mod1<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(meanTday)+scale(moist_per)+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2),allplants)
summary(mod1)
NagelkerkeR2(mod1)
summary(mod1)
NagelkerkeR2(mod1)
library(MASS)
library(fmsb)
library(gstat)
library(car)
library(spdep)
library(ncf)
library(nlme)
allplants.nb <- dnearneigh(allplants, 0, 20)
allplants.listw <- nb2listw(allplants.nb)
install.packages("beepr")
library(beepr)
beep(sound = 8, expr = NULL)
library(MASS)
library(fmsb)
library(gstat)
library(car)
library(spdep)
library(ncf)
library(nlme)
allplants.listw
summary(allplants.listw)
summary(markedplants.listw)
markedplants.listw
allplants.nb
allplants.listw
GlobMT1<- moran.test(n_eggs_max, listw=allplants.listw)
GlobMT1<- moran.test(allplants$n_eggs_max, listw=allplants.listw)
iibrary(beepr)
beep(sound=8,expr=NULL)
GlobMT1
GlobMT2<- moran.test(res1, listw=allplants.listw)
correlog1 <- correlog(allplants$x, allplants$y, allplants$n_eggs_max,increment=1, resamp=0) #Slow
correlog3 <- correlog(allplants$x, allplants$y, res1,increment=1, resamp=0) #Slow
GlobMT2
ac
correlog1 <- correlog(allplants$x, allplants$y, allplants$n_eggs_max,increment=1, resamp=0) #Slow
library(MASS)
library(fmsb)
library(gstat)
library(car)
library(spdep)
library(ncf)
library(nlme)
GlobMT1
GlobMT2
correlog1
correlog3
AIC(mod2aut,mod2aut_sq) #Model with ac_mark is better
mod1_int<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(as.integer(phen)):scale(Mrub_sum)+scale(as.integer(phen)):scale(phen_n2)+scale(pldens_2):scale(phen_n2),allplants)
summary(mod1_int)
NagelkerkeR2(mod1_int)
res1_int<-residuals(mod1_int)
bubble(allplants,"n_eggs_max")
bubble(allplants,"Mrub_sum")
mod1_int<-glm.nb(n_eggs_max~phen+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
phen:scale(Mrub_sum)+phen:scale(phen_n2)+scale(pldens_2):scale(phen_n2),allplants)
summary(mod1_int)
mod1_int<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(as.integer(phen)):scale(Mrub_sum)+scale(as.integer(phen)):scale(phen_n2)+scale(pldens_2):scale(phen_n2),allplants)
summary(mod1_int)
NagelkerkeR2(mod1_int)
res1_int<-residuals(mod1_int)
plot(variogram(res1_int~1,data=allplants))
summary(mod1_int)
NagelkerkeR2(mod1_int)
res1_int<-residuals(mod1_int)
plot(variogram(res1_int~1,data=allplants))
library(pscl)
?hurdle
mod1_int_h<-hurdle(n_eggs_max~scale(as.integer(phen))+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(as.integer(phen)):scale(Mrub_sum)+scale(as.integer(phen)):scale(phen_n2)+scale(pldens_2):scale(phen_n2),
dist="negbin",zero.dist="binomial",allplants)
summary(mod1_int_h)
NagelkerkeR2(mod1_int_h)
plot(mod1_int_h)
summary(mod1_int_h)
plot(mod1_int_h)
res1_int_h<-residuals(mod1_int_h)
plot(mod1_int)
qqplot(res1_int_h)
str(res1_int_h)
str(res1_int_h)
res1_int_h$
residuals
res1_int_h$res
res1_int_h$residuals
str(mod1_int_h)
plot(mod1_int_h$fitted.values,mod1_int_h$residuals)
plot(variogram(res1_int_h~1,data=allplants))
AIC(mod1_int,mod1_int_h)
names(allplants)
allplants$attack
allplants$attack<-ifelse(allplants$n_eggs_max>0,1,0)
hist(allplants$attack)
str(allplants)
allplants$attack<-as.factor(ifelse(allplants$n_eggs_max>0,1,0))
mod1_int_bin<-glm(attack~scale(as.integer(phen))+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(as.integer(phen)):scale(Mrub_sum)+scale(as.integer(phen)):scale(phen_n2)+scale(pldens_2):scale(phen_n2),allplants)
mod1_int_bin<-glm(attack~scale(as.integer(phen))+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(as.integer(phen)):scale(Mrub_sum)+scale(as.integer(phen)):scale(phen_n2)+scale(pldens_2):scale(phen_n2),
family="binomial",allplants)
summary(mod1_int_bin)
NagelkerkeR2(mod1_int_bin)
res1_int_bin<-residuals(mod1_int_bin)
plot(variogram(res1_int_bin~1,data=allplants))
mod1_int_count<-glm.nb(attack~scale(as.integer(phen))+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(as.integer(phen)):scale(Mrub_sum)+scale(as.integer(phen)):scale(phen_n2)+scale(pldens_2):scale(phen_n2),
subset(allplants,attack==1))
mod1_int_count<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(as.integer(phen)):scale(Mrub_sum)+scale(as.integer(phen)):scale(phen_n2)+scale(pldens_2):scale(phen_n2),
subset(allplants,attack==1))
summary(mod1_int_count)
NagelkerkeR2(mod1_int_count)
res1_int_count<-residuals(mod1_int_count)
plot(variogram(res1_int_count~1,data=allplants))
plot(variogram(res1_int_count~1,data=subset(allplants,attack==1)))
summary(mod1_int_bin)
NagelkerkeR2(mod1_int_count)
summary(mod1_int_bin)
summary(mod1_int_count)
plot(mod1_int_bin)
plot(mod1_int_count)
summary(mod1_int_h)
nullmodel_eggs<-hurdle(n_eggs_max~1,data=allplants,dist="negbin",zero.dist="binomial")
2*logLik(mod1_int_h)     # Deviance model_eggs
2*logLik(nullmodel_eggs)  # Deviance null model
(-8695.87-(-6849.654))/-8695.87 # 8.5% !?
AIC(mod1_int,mod1_int_h) #Hurdle better than negative binomial
?hurdle
hurdletesst(mod1_int_h)
hurdletest(mod1_int_h)
vuong(mod1_int,mod1_int_h)
(-8695.87-(-6849.654))/-8695.87 # 21% !?
summary(mod1_int_bin)
summary(mod1_int_count)
summary(mod1_int_h)
summary(mod1_int_count)
summary(mod1_int)
summary(mod1_int_bin)
NagelkerkeR2(mod1_int_bin)
NagelkerkeR2(mod1_int_count)
NagelkerkeR2(mod1_int_h)
NagelkerkeR2(mod1_int)
#Temp, moist on phen, ants, dens ####
mod_phen<-lm(as.integer(phen)~scale(meanTday)*scale(moist_per),allplants, na.action="na.fail")
summary(mod_phen)
mod_ants<-glm.nb(Mrub_sum~scale(meanTday)*scale(moist_per),allplants, na.action="na.fail")
summary(mod_ants)
plot(allplants$meanTday,allplants$Mrub_sum)
plot(allplants$moist_per,allplants$Mrub_sum)
mod_dens<-lm(pldens_2~scale(meanTday)*scale(moist_per),allplants, na.action="na.fail")
summary(mod_dens)
plot(allplants$meanTday,allplants$pldens_2)
plot(allplants$moist_per,allplants$pldens_2)
mod_phen_neigh<-lm(phen_n2~scale(meanTday)*scale(moist_per),allplants, na.action="na.fail")
summary(mod10)
plot(allplants$meanTday,allplants$phen_n2)
plot(allplants$moist_per,allplants$phen_n2)
library(MASS)
#Temp, moist on phen, ants, dens ####
mod_phen<-lm(as.integer(phen)~scale(meanTday)*scale(moist_per),allplants, na.action="na.fail")
summary(mod_phen)
mod_ants<-glm.nb(Mrub_sum~scale(meanTday)*scale(moist_per),allplants, na.action="na.fail")
summary(mod_ants)
plot(allplants$meanTday,allplants$Mrub_sum)
plot(allplants$moist_per,allplants$Mrub_sum)
mod_dens<-lm(pldens_2~scale(meanTday)*scale(moist_per),allplants, na.action="na.fail")
summary(mod_dens)
plot(allplants$meanTday,allplants$pldens_2)
plot(allplants$moist_per,allplants$pldens_2)
mod_phen_neigh<-lm(phen_n2~scale(meanTday)*scale(moist_per),allplants, na.action="na.fail")
summary(mod10)
plot(allplants$meanTday,allplants$phen_n2)
plot(allplants$moist_per,allplants$phen_n2)
#Temp, moist on phen, ants, dens ####
mod_phen<-lm(as.integer(phen)~scale(meanTday)*scale(moist_per),allplants, na.action="na.fail")
summary(mod_phen)
mod_ants<-glm.nb(Mrub_sum~scale(meanTday)*scale(moist_per),allplants, na.action="na.fail")
summary(mod_ants)
plot(allplants$meanTday,allplants$Mrub_sum)
plot(allplants$moist_per,allplants$Mrub_sum)
mod_dens<-lm(pldens_2~scale(meanTday)*scale(moist_per),allplants, na.action="na.fail")
summary(mod_dens)
plot(allplants$meanTday,allplants$pldens_2)
plot(allplants$moist_per,allplants$pldens_2)
mod_phen_neigh<-lm(phen_n2~scale(meanTday)*scale(moist_per),allplants, na.action="na.fail")
summary(mod_phen_neigh)
plot(allplants$meanTday,allplants$phen_n2)
plot(allplants$moist_per,allplants$phen_n2)
library(MASS)
library(fmsb)
library(gstat)
library(car)
library(spdep)
library(ncf)
library(nlme)
ac <- autocov_dist(allplants$n_eggs_max, coords, nbs = 20, type = "inverse",style="B") #Slow
library(MASS)
library(fmsb)
library(gstat)
library(car)
library(spdep)
library(ncf)
library(nlme)
ac
mod1aut<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(ac),allplants)
summary(mod1aut)
NagelkerkeR2(mod1aut)
res1aut<-residuals(mod1aut)
mod1aut_int<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(as.integer(phen)):scale(Mrub_sum)+scale(as.integer(phen)):scale(phen_n2)+scale(pldens_2):scale(phen_n2)+
scale(ac),allplants)
summary(mod1aut_int)
NagelkerkeR2(mod1aut_int)
res1aut_int<-residuals(mod1aut)
library(MASS)
library(fmsb)
library(gstat)
library(car)
library(spdep)
library(ncf)
library(nlme)
?lineplot.CI
??lineplot.CI
library(sciplot)
lineplot.CI(allplants$phen_n2,allplants$n_eggs_max)
lineplot.CI(allplants$phen,allplants$n_eggs_max)
plot(allplants$phen,allplants$n_eggs_max)
lineplot.CI(allplants$phen,allplants$n_eggs_max,type=lines)
lineplot.CI(allplants$phen,allplants$n_eggs_max,type="l")
lineplot.CI(allplants$phen,allplants$n_eggs_max,type="p")
lineplot.CI(allplants$phen,allplants$n_eggs_max,xlab=NULL,ylab="Mean number of eggs")
lineplot.CI(allplants$phen,allplants$n_eggs_max,xlab="NULL",ylab="Mean number of eggs")
lineplot.CI(allplants$phen,allplants$n_eggs_max,xlab=NULL,ylab="Mean number of eggs")
levels(allplants$phen)
subset(allplants,!phen=="")
str(subset(allplants,!phen==""))
str(subset(allplants,!phen==NA))
str(subset(allplants,!phen==""))
str(subset(allplants,!phen==" "))
allplants$phen
View(allplants_df)
as.integer(allplants$phen)
allplants$phen
subset(allplants,as.integer(phen)=="1")
allplants,as.integer(phen)=="1"
allplants[as.integer(phen)=="1"]
allplants[as.integer(allplants$phen)=="1"]
allplants[allplants$phen=="1"]
allplants$phen <- as.character(allplants$phen)
allplants$phen[allplants$phen==""] <- "NA"
allplants$phen <- as.factor(allplants$phen)
lineplot.CI(allplants$phen,allplants$n_eggs_max,xlab=NULL,ylab="Mean number of eggs")
allplants$phen
allplants$phen <- as.character(allplants$phen)
allplants$phen[allplants$phen==" "] <- "NA"
allplants$phen <- as.factor(allplants$phen)
lineplot.CI(allplants$phen,allplants$n_eggs_max,xlab=NULL,ylab="Mean number of eggs")
str(allplants)
allplants$phen <- as.character(allplants$phen)
allplants$phen <- as.factor(allplants$phen)
str(allplants)
lineplot.CI(allplants$phen,allplants$n_eggs_max,xlab=NULL,ylab="Mean number of eggs")
levels(allplants$phen)<-droplevels(allplants$phen)
lineplot.CI(allplants$phen,allplants$n_eggs_max,xlab=NULL,ylab="Mean number of eggs")
str(allplants)
allplants<-read.table("./gis/tables/plants_wmdata.txt",header=T,sep=",",dec=".")
head(allplants)
str(allplants)
allplants$phen <- as.character(allplants$phen)
allplants$phen[allplants$phen==" "] <- "NA"
allplants$phen <- as.factor(allplants$phen)
str(allplants)
allplants<-read.table("./gis/tables/plants_wmdata.txt",header=T,sep=",",dec=".")
head(allplants)
allplants<-read.table("./gis/tables/plants_wmdata.txt",header=T,sep="\t",dec=".")
head(allplants)
str(allplants)
allplants$phen
allplants$idMark<-NULL
allplants$date_map<-NULL
allplants$plot_id<-NULL
allplants$phen_1<-NULL
allplants$eggs<-ifelse(allplants$pl_id>0,NA,allplants$eggs)
allplants$n_shoots<-ifelse(is.na(allplants$pl_id),NA,allplants$n_shoots)
allplants$n_fl<-ifelse(is.na(allplants$pl_id),NA,allplants$n_fl)
allplants$pl_id<-ifelse(allplants$pl_id>0,allplants$pl_id,NA)
allplants$shoot_h<-ifelse(is.na(allplants$pl_id),NA,allplants$shoot_h)
allplants$n_eggs_1<-ifelse(is.na(allplants$pl_id),NA,allplants$n_eggs_1)
allplants$OID_<-NULL
allplants[allplants == -9999] <- NA
allplants$veg_h_1<-ifelse(is.na(allplants$pl_id),NA,allplants$veg_h_1)
allplants$n_eggs_2<-ifelse(is.na(allplants$pl_id),NA,allplants$n_eggs_2)
allplants$veg_h_2<-ifelse(is.na(allplants$pl_id),NA,allplants$veg_h_2)
allplants$bud_in<-ifelse(is.na(allplants$pl_id),NA,allplants$bud_in)
allplants$bud_ab<-ifelse(is.na(allplants$pl_id),NA,allplants$bud_ab)
allplants$bud_pr<-ifelse(is.na(allplants$pl_id),NA,allplants$bud_pr)
allplants$fl_pr<-ifelse(is.na(allplants$pl_id),NA,allplants$fl_pr)
allplants$fl_ab<-ifelse(is.na(allplants$pl_id),NA,allplants$fl_ab)
allplants$fl_in<-ifelse(is.na(allplants$pl_id),NA,allplants$fl_in)
allplants$fr_in<-ifelse(is.na(allplants$pl_id),NA,allplants$fr_in)
allplants$fr_inC<-ifelse(is.na(allplants$pl_id),NA,allplants$fr_inC)
allplants$fr_prC<-ifelse(is.na(allplants$pl_id),NA,allplants$fr_prC)
allplants$fr_ab<-ifelse(is.na(allplants$pl_id),NA,allplants$fr_ab)
allplants$fr_pr<-ifelse(is.na(allplants$pl_id),NA,allplants$fr_pr)
allplants$n_eggs_max<-with(allplants,pmax(eggs,n_eggs_1,n_eggs_2,na.rm=T))
allplants$state_afte<-ifelse(is.na(allplants$pl_id),NA,allplants$state_afte)
allplants$state_af_1<-ifelse(is.na(allplants$pl_id),NA,allplants$state_af_1)
allplants$veg_h_mean<-rowMeans(allplants[,10:11],na.rm=T)
allplants$veg_h_mean[is.nan(allplants$veg_h_mean)==TRUE] <- NA
#Defining coordinates and coordinate system####
coordinates(allplants) <- c("x", "y")
proj4string(allplants) = CRS(project1) #assign CRS with projected coordinates
#Extrapolations
allplants$meanT<-over(allplants,krig1_meanT$krige_output)$var1.pred
allplants$maxT<-over(allplants,krig1_maxT$krige_output)$var1.pred
allplants$minT<-over(allplants,krig1_minT$krige_output)$var1.pred
allplants$sdT<-over(allplants,krig1_sdT$krige_output)$var1.pred
allplants$rangeT<-over(allplants,krig1_rangeT$krige_output)$var1.pred
allplants$meanTday<-over(allplants,krig1_meanTday$krige_output)$var1.pred
allplants$maxTday<-over(allplants,krig1_maxTday$krige_output)$var1.pred
allplants$minTday<-over(allplants,krig1_minTday$krige_output)$var1.pred
allplants$sdTday<-over(allplants,krig1_sdTday$krige_output)$var1.pred
allplants$rangeTday<-over(allplants,krig1_rangeTday$krige_output)$var1.pred
allplants$moist_per<-over(allplants,krig1_MOIST_PER$krige_output)$var1.pred
allplants$moist_mv<-over(allplants,krig1_MOIST_MV$krige_output)$var1.pred
allplants$Mrub_sum<-over(allplants,idw1_Mrub_sum)$var1.pred
allplants$Msca_sum<-over(allplants,idw1_Msca_sum)$var1.pred
allplants$Mrug_sum<-over(allplants,idw1_Mrug_sum)$var1.pred
allplants$Msch_sum<-over(allplants,idw1_Msch_sum)$var1.pred
allplants$oth_sum<-over(allplants,idw1_oth_sum)$var1.pred
allplants$Mrub_max<-over(allplants,idw1_Mrub_max)$var1.pred
allplants$Msca_max<-over(allplants,idw1_Msca_max)$var1.pred
allplants$Mrug_max<-over(allplants,idw1_Mrug_max)$var1.pred
allplants$Msch_max<-over(allplants,idw1_Msch_max)$var1.pred
allplants$oth_max<-over(allplants,idw1_oth_max)$var1.pred
allplants$Mrub_pres<-over(allplants,idw1_Mrub_pres)$var1.pred
allplants$Msca_pres<-over(allplants,idw1_Msca_pres)$var1.pred
allplants$Mrug_pres<-over(allplants,idw1_Mrug_pres)$var1.pred
allplants$Msch_pres<-over(allplants,idw1_Msch_pres)$var1.pred
allplants$oth_pres<-over(allplants,idw1_oth_pres)$var1.pred
allplants$allM_sum<-over(allplants,idw1_allM_sum)$var1.pred
allplants$allM_max<-over(allplants,idw1_allM_max)$var1.pred
allplants$allM_pres<-over(allplants,idw1_allM_pres)$var1.pred
allplants$Mrub_rug_s<-over(allplants,idw1_Mrub_rug_s)$var1.pred
allplants$Mrub_rug_m<-over(allplants,idw1_Mrub_rug_m)$var1.pred
allplants$Mrub_rug_p<-over(allplants,idw1_Mrub_rug_p)$var1.pred
#Divide marked plants between those that have GIS data and those that have not
mplants_GIS<-subset(allplants,!is.na(pl_id))
mplants_noGIS<-mplants[!mplants$pl_id %in% mplants_GIS$pl_id,]
str(mplants_GIS)
str(mplants_noGIS)
#allplants does not include plan
plants_pldens<-read.table("./gis/tables/plants_pldens.txt",header=T,sep=",",dec=".")
head(plants_pldens)
str(plants_pldens)
allplants<-merge(allplants,plants_pldens)
head(allplants)
plants_phen_neigh<-read.table("./gis/tables/plants_phen_neigh.txt",header=T,sep=",",dec=".")
head(plants_phen_neigh)
plants_phen_neigh$FID_1<-NULL
str(plants_phen_neigh)
plants_phen_neigh$FID_12<-NULL
plants_phen_neigh$FID_12_13<-NULL
plants_phen_neigh$FID_12_13_14<-NULL
plants_phen_neigh$OID_<-NULL
plants_phen_neigh$phen_n05<-with(plants_phen_neigh,ifelse(phen_num==-9999,phen_n05_s/phen_n05_c,
((phen_n05_s-phen_num)/(phen_n05_c-1))
))
plants_phen_neigh$phen_n1<-with(plants_phen_neigh,ifelse(phen_num==-9999,phen_n1_s/phen_n1_c,
((phen_n1_s-phen_num)/(phen_n1_c-1))
))
plants_phen_neigh$phen_n5<-with(plants_phen_neigh,ifelse(phen_num==-9999,phen_n5_s/phen_n5_c,
((phen_n5_s-phen_num)/(phen_n5_c-1))
))
plants_phen_neigh$phen_n10<-with(plants_phen_neigh,ifelse(phen_num==-9999,phen_n10_s/phen_n10_c,
((phen_n10_s-phen_num)/(phen_n10_c-1))
))
plants_phen_neigh$phen_n05[is.nan(plants_phen_neigh$phen_n05)] <- NA
plants_phen_neigh$phen_n2<-with(plants_phen_neigh,ifelse(phen_num==-9999,phen_n2_s/phen_n2_c,
((phen_n2_s-phen_num)/(phen_n2_c-1))
))
plants_phen_neigh$phen_n1[is.nan(plants_phen_neigh$phen_n1)] <- NA
plants_phen_neigh[c(1,13:17)]
allplants<-merge(allplants,plants_phen_neigh[c(1,13:17)])
head(allplants)
lineplot.CI(allplants$phen,allplants$n_eggs_max,xlab=NULL,ylab="Mean number of eggs")
library(MASS)
library(fmsb)
library(gstat)
library(car)
library(spdep)
library(ncf)
library(nlme)
correlog3aut <- correlog(allplants$x, allplants$y,res1aut,increment=1,resamp=100)
plot(correlog3aut)
correlog3aut_int <- correlog(allplants$x, allplants$y,res1aut_int,increment=1,resamp=100)
plot(correlog3aut_int)
GlobMT2aut<- moran.test(res1aut, listw=allplants.listw)
GlobMT2aut
GlobMT2aut_int<- moran.test(res1aut_int, listw=allplants.listw)
GlobMT2aut_int
library(MASS)
library(fmsb)
library(gstat)
library(car)
library(spdep)
library(ncf)
library(nlme)
lineplot.CI(allplants$phen,allplants$n_eggs_max,xlab=NULL,ylab="Mean number of eggs")
library(sciplot)
lineplot.CI(allplants$phen,allplants$n_eggs_max,xlab=NULL,ylab="Mean number of eggs")
?lineplot.CI
str(subset(allplants,as.integer(phen)=="1"))
lineplot.CI(allplants$phen,allplants$n_eggs_max,xlab=NULL,ylab="Mean number of eggs",pch=5)
lineplot.CI(allplants$phen,allplants$n_eggs_max,xlab=NULL,ylab="Mean number of eggs")
library(MASS)
library(fmsb)
library(gstat)
library(car)
library(spdep)
library(ncf)
library(nlme)
plot(correlog3aut)
plot(correlog3aut_int)
GlobMT2aut
GlobMT2aut_int
summary(mod1aut)
plot(correlog4aut)
GlobMT4aut#No significant autocorrelation after including autocovariate!
summary(mod2aut)
mod2aut_int<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(meanTday)+scale(moist_per)+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(as.integer(phen)):scale(Mrub_sum)+scale(as.integer(phen)):scale(phen_n2)+scale(pldens_2):scale(phen_n2)+
scale(ac_mark),subset(allplants,!is.na(pl_id)))
summary(mod2aut_int)
NagelkerkeR2(mod2aut_int)
mod2aut_int<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(as.integer(phen)):scale(Mrub_sum)+scale(as.integer(phen)):scale(phen_n2)+scale(pldens_2):scale(phen_n2)+
scale(ac_mark),subset(allplants,!is.na(pl_id)))
summary(mod2aut_int)
NagelkerkeR2(mod2aut_int)
res2aut_int<-residuals(mod2aut_int)
correlog4aut <- correlog(subset(allplants,!is.na(pl_id))$x, subset(allplants,!is.na(pl_id))$y,
res2aut_int,increment=1, resamp=100)
correlog4aut <- correlog(subset(allplants,!is.na(pl_id))$x, subset(allplants,!is.na(pl_id))$y,
res2aut,increment=1, resamp=100)
correlog4aut_int <- correlog(subset(allplants,!is.na(pl_id))$x, subset(allplants,!is.na(pl_id))$y,
res2aut_int,increment=1, resamp=100)
plot(correlog4aut_int)
GlobMT4aut_int<- moran.test(res2aut_int, listw=markedplants.listw)
GlobMT4aut_int#No significant autocorrelation after including autocovariate!
mod2aut_int<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(as.integer(phen)):scale(Mrub_sum)+scale(as.integer(phen)):scale(phen_n2)+scale(pldens_2):scale(phen_n2)+
scale(ac_mark),subset(allplants,!is.na(pl_id)))
summary(mod2aut_int)
NagelkerkeR2(mod2aut_int)
res2aut_int<-residuals(mod2aut_int)
GlobMT4aut_int<- moran.test(res2aut_int, listw=markedplants.listw)
nobs(mod2aut_int)
str(markedplants.listw)
str(markedplants.nb)
nobs(mod2aut_int)
str(subset(allplants,!is.na(pl_id)))
GlobMT4aut_int<- moran.test(res2aut_int, listw=markedplants.listw)
str(allplants)
names(alldata)
names(allplants)
plot(allplants$pldens_2,allplants$n_eggs_max)
plot(allplants$pldens_2,allplants$n_eggs_max)
plot(allplants$phen_n2,allplants$n_eggs_max)
summary(mod1aut_int)
plot(allplants$Mrub_sum,allplants$n_eggs_max)
mod2aut_int<-glm.nb(n_eggs_max~scale(as.integer(phen))+scale(Mrub_sum)+scale(pldens_2)+scale(phen_n2)+
scale(as.integer(phen)):scale(Mrub_sum)+scale(as.integer(phen)):scale(phen_n2)+scale(pldens_2):scale(phen_n2)+
scale(ac_mark),subset(allplants,!is.na(pl_id)))
summary(mod2aut_int)
NagelkerkeR2(mod2aut_int)
summary(mod2aut)
plot(correlog3aut)
plot(correlog3)
