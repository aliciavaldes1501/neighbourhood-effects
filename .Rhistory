ants_T<-read.table("./data/raw/tanga2016_ants.txt",header=T,sep="\t",dec=".")
head(ants_T)
with(ants_T,hist(Mrubra))
with(ants_T,table(Mrubra))
with(ants_T,table(Mrubra,Mscabrinodis))
head(ants_T)
?barplot
with(ants_T,barplot(Mrubra))
with(ants_T,barplot(sum(Mrubra)))
with(ants_T,barplot(c(sum(Mrubra),sum(Mscabrinodis))))
ggplot(ants_T, aes(Mrubra,Mscabrinodis))
library(ggplot2)
ggplot(ants_T, aes(Mrubra,Mscabrinodis))
ggplot(ants_T)+geom_bar(Mrubra)
ggplot(ants_T,aes(Mrubra))+geom_bar(Mrubra)
ggplot(ants_T,aes(Mrubra))+geom_bar(Mrubra)
library(tidyr)
?gather
head(ants_T)
ants_T_long<-gather(ants_T,species,number,Mrubra,Mscabrinodis,Mruginodis,Mschencki,others,factor_key=TRUE)
install.packages("DBI")
library(tidyr)
r
ants_T_long<-gather(ants_T,species,number,Mrubra,Mscabrinodis,Mruginodis,Mschencki,others,factor_key=TRUE)
ants_T_long
head(ants_T)
head(ants_T_long)
str(ants_T)
str(ants_T_long)
ants_T_long$point_id<-as.factor(ants_T_long$point_id)
head(ants_T_long)
ants_T_long$point_id<-as.factor(ants_T_long$point_id)
str(ants_T_long)
ggplot(ants_T_long,aes(species,number))
ggplot(ants_T_long,aes(x=species,y=number,fill=species))
ggplot(ants_T_long,aes(x=species,y=number,fill=species))+geom_bar(stat="identity")
ggplot(ants_T_long,aes(x=species,y=number,fill=species))+geom_bar(stat="identity")+guides(fill=FALSE)
ggplot(ants_T_long,aes(x=species,y=number,fill=species))+geom_bar(stat="identity")+guides(fill=FALSE)ants_T
with(ants_T,sum(Mruginodis))
head(ants_T)
head(ants_T_long)
?spread
ants_T_wide <- spread(ants_T, date, Mrubra,Mscabrinodis)
ants_T_wide <- spread(ants_T, date, c(Mrubra,Mscabrinodis))
head(spread(ants_T, date, Mrubra))
spread(ants_T, date, Mrubra,drop=F)
head(spread(ants_T, date, Mrubra,drop=F))
head(spread(ants_T_long, date,species))
head(spread(ants_T_long, date,number))
ants_T_long_wide <- spread(ants_T_long, date,number)
?ifelse
ants_T_long$date_id<-ifelse(ants_T_long$date=="03/09/2016",2,1)
str(ants_T_long)
ants_T_long$date_id<-as.factor(ifelse(ants_T_long$date=="03/09/2016",2,1))
str(ants_T_long)
ants_T_long_wide <- spread(ants_T_long,date_id,number)
head(ants_T_long)
ants_T_long_wide <- spread(ants_T_long,species,number)
ants_T_long_wide <-dcast(ants_T_long, point_id + species ~ date_id, value.var="number")
library(reshape2)
ants_T_long_wide <-dcast(ants_T_long, point_id + species ~ date_id, value.var="number")
ants_T_long_wide <-dcast(ants_T_long, point_id + species ~ date_id, value.var="number")
head(ants_T_long_wide)
?dcast
ants_T_long_wide <-dcast(ants_T_long, point_id + species ~ date, value.var="number")
head(ants_T_long_wide)
ants_T_long_wide <-dcast(ants_T_long, point_id + species ~ date, value.var="number",fun.aggregate=mean)
head(ants_T_long_wide)
ants_T_long_wide <-dcast(ants_T_long, point_id + species ~ date, value.var="number",fun.aggregate=sum)
head(ants_T_long_wide)
head(ants_T)
head(ants_T_long_wide)
ants_T_long_wide
ants_T_long$date_id<-as.factor(ifelse(ants_T_long$date=="03/09/2016","date2","date1"))
ants_T_long_wide <-dcast(ants_T_long, point_id + species ~ date, value.var="number",fun.aggregate=sum)
head(ants_T_long_wide)
ants_T_long_wide <-dcast(ants_T_long, point_id + species ~ date_id, value.var="number",fun.aggregate=sum)
head(ants_T_long_wide)
ants_T_long_wide
View(ants_T)
View(ants_T)
head(ants_T_long)
ants_T_long_wide$sumdates<-ants_T_long_wide$date1+ants_T_long_wide$date2
head(ants_T_long_wide)
ants_T_long_wide$pres<-as.factor(ifelse(ants_T_long_wide>0,1,0))
ants_T_long_wide$pres<-as.factor(ifelse(ants_T_long_wide$sumdates>0,1,0))
head(ants_T_long_wide)
head(dcast(ants_T_long_wide, point_id ~ species, value.var="pres"))
ants_pres<-dcast(ants_T_long_wide, point_id ~ species, value.var="pres")
head(ants_pres)
str(ants_pres)
rm(ants_pres)
ants_T_pres<-dcast(ants_T_long_wide, point_id ~ species, value.var=as.factor("pres"))
head(ants_T_pres)
str(ants_T_pres)
ants_T_pres<-dcast(ants_T_long_wide, point_id ~ species, value.var="pres")
ants_T_pres$Mrubra<-as.factor(ants_T_pres$Mrubra)
ants_T_pres$Mscabrinodis<-as.factor(ants_T_pres$Mscabrinodis)
ants_T_pres$Mruginodis<-as.factor(ants_T_pres$Mruginodis)
ants_T_pres$Mschencki<-as.factor(ants_T_pres$Mschencki)
ants_T_pres$others<-as.factor(ants_T_pres$others)
head(ants_T_pres)
str(ants_T_pres)
head(ants_T_long)
head(ants_T_long)
head(ants_T_long_wide)
head(ants_T_pres)
ggplot(ants_T_long_wide,aes(x=species,y=pres,fill=species))+geom_bar(stat="identity")+guides(fill=FALSE)
rm(ants_T_pres)
ggplot(ants_T_long_wide,aes(x=species,y=pres,fill=species))+geom_bar(stat="sum")+guides(fill=FALSE)
head(ants_T_long_wide)
ggplot(ants_T_long_wide,aes(x=species,y=pres,fill=species))+geom_bar(stat="count")+guides(fill=FALSE)
ggplot(ants_T_long_wide,aes(x=species,fill=species))+geom_bar(stat="count")+guides(fill=FALSE)
ggplot(ants_T_long_wide,aes(x=species,y=pres,fill=species))+geom_bar(stat="identity")+guides(fill=FALSE)
ggplot(ants_T_long_wide,aes(x=species,y=sum(pres),fill=species))+geom_bar(stat="identity")+guides(fill=FALSE)
ants_T_long_wide$pres<-ifelse(ants_T_long_wide$sumdates>0,1,0)
ggplot(ants_T_long_wide,aes(x=species,y=pres,fill=species))+geom_bar(stat="identity")+guides(fill=FALSE)
ggplot(ants_T_long,aes(x=species,y=number,fill=species))+geom_bar(stat="identity")+guides(fill=FALSE)
ggplot(ants_T_long,aes(x=species,y=number,fill=species))+geom_bar(stat="identity")+guides(fill=FALSE)
ggplot(ants_T_long,aes(x=species,y=number,fill=species))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")
ggplot(ants_T_long,aes(x=species,y=number,fill=species))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Total number of individuals")
ggplot(ants_T_long_wide,aes(x=species,y=pres,fill=species))+geom_bar(stat="identity")+guides(fill=FALSE
)
ggplot(ants_T_long_wide,aes(x=species,y=pres,fill=species))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Number of points with presence")
ggplot(ants_T_long_wide,aes(x=species,y=pres))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Number of points with presence")
ggplot(ants_T_long,aes(x=species,y=number))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Total number of individuals")
ggplot(ants_T_long,aes(x=species,y=number))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Total number of individuals")+theme_base()
library(ggthemes)
ggplot(ants_T_long,aes(x=species,y=number))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Total number of individuals")+theme_base()
ggplot(ants_T_long,aes(x=species,y=number))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Total number of individuals")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
pdf("./results/figures/total_indiv_ants.pdf", family="Times",width=7,height=3)
ggplot(ants_T_long,aes(x=species,y=number))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Total number of individuals")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
ggplot(ants_T_long,aes(x=species,y=number))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Total number of individuals")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(ants_T_long_wide,aes(x=species,y=pres))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Number of points with presence")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
pdf("./results/figures/total_indiv_ants.pdf", family="Times")
ggplot(ants_T_long,aes(x=species,y=number))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Total number of individuals")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(ants_T_long_wide,aes(x=species,y=pres))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Number of points with presence")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
pdf("./results/figures/ant_counts.pdf", family="Times")
ggplot(ants_T_long,aes(x=species,y=number))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Total number of individuals")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(ants_T_long_wide,aes(x=species,y=pres))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Number of points with presence")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
pdf("./results/figures/ant_counts_T.pdf", family="Times")
ggplot(ants_T_long,aes(x=species,y=number))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Total number of individuals")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(ants_T_long_wide,aes(x=species,y=pres))+geom_bar(stat="identity")+guides(fill=FALSE)+
xlab("Species")+ylab("Number of points with presence")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
mplants1<-read.table("./data/raw/tanga2016_plants1.txt",header=T,sep="\t",dec=".")
mplants2<-read.table("./data/raw/tanga2016_plants2.txt",header=T,sep="\t",dec=".")
mplants3<-read.table("./data/raw/tanga2016_plants3.txt",header=T,sep="\t",dec=".")
glimpse(mplants1)
head(mplants1)
tail(mplants1)
head(mplants2)
tail(mplants2)
mplants2$phen
head(mplants3)
tail(mplants3)
head(mplants3)
tail(mplants3)
head(mplants1)
tail(mplants1)
str(mplants1)
head(mplants2)
tail(mplants2)
str(mplants2)
head(mplants3)
tail(mplants3)
str(mplants3)
mplants1$plot_id<-as.factor(mplants1$plot_id)
mplants2$comments2<-as.string(mplants2$comments2)
mplants2$comments2<-as.text(mplants2$comments2)
mplants2$comments2<-as.character(mplants2$comments2)
mplants2$new_mark<-as.factor(mplants2$new_mark)
mplants2$plot_id<-as.factor(mplants2$plot_id)
mplants3$comments3<-as.character(mplants3$comments3)
head(mplants1)
tail(mplants1)
head(mplants2)
tail(mplants2)
head(mplants3)
tail(mplants3)
str(mplants1)
str(mplants2)
str(mplants3)
head(mplants1)
head(mplants1)
head(mplants2)
head(mplants3)
subset(mplants2,new_mark=0)
head(mplants1)
head(mplants2)
head(mplants3)
str(subset(mplants2,new_mark=0))
str(mplants2)
str(subset(mplants2,new_mark="0"))
str(subset(mplants2,new_mark==0))
str(mplants1)
head(mplants1)
head(mplants2)
head(subset(mplants2,new_mark==0)[1:7])
mplants<-merge(mplants1,subset(mplants2,new_mark==0)[1:7])
head(mplants)
str(mplants)
subset(mplants,n_fl==NA)
subset(mplants,n_fl=="NA")
subset(mplants,is.na(n_fl))
str(mplants1)
str(mplants2)
str(subset(mplants2,new_mark==0)[1:7]) #
str(mplants1)
str(mplants2)
str(mplants3)
621-614
?merge
str(mplants)
mplants<-merge(mplants1,subset(mplants2,new_mark==0)[1:7],all.x=T,all.y=T)
head(mplants)
str(mplants)
subset(mplants,is.na(n_fl))
str(mplants3) #715 plants
subset(mplants,is.na(new_mark))
str(mplants) #621
subset(mplants,is.na(new_mark))$new_mark #7 plants marked on visit 1 that had no data on visit 2
subset(mplants,is.na(new_mark))$new_mark<-0 #7 plants marked on visit 1 that had no data on visit 2
subset(mplants,is.na(new_mark))$new_mark<-c(0,0,0,0,0,0,0) #7 plants marked on visit 1 that had no data on visit 2
subset(mplants,is.na(new_mark)) #7 plants marked on visit 1 that had no data on visit 2
subset(mplants,is.na(new_mark)) #7 plants marked on visit 1 that had no data on visit 2
?ifelse
mplants[c("new_mark")][is.na(mplants[c("new_mark")])]
mplants[c("new_mark")][is.na(mplants[c("new_mark")])] <- 0
mplants[c("comments2")][is.na(mplants[c("comments2")])] <- "Not included in mplants2. This comment was manually typed in R"
subset(mplants,is.na(new_mark)) #7 plants marked on visit 1 that had no data on visit 2
subset(mplants,is.na(n_fl))
subset(mplants,is.na(n_fl))
head(mplants)
subset(mplants,is.na(n_fl))
mplants
head(mplants)
head(mplants)
str(mplants)
head(mplants2)
head(mplants)
?update
?merge
str(mplants)
str(subset(mplants2,new_mark==1)) # plants
614+94
mplants<-merge(mplants,subset(mplants2,new_mark==1),all.x=T,all.y=T)
head(mplants)
str(mplants)
621+94
head(mplants)
head(mplants3)
head(mplants)
head(mplants3)
mplants<-merge(mplants,mplants3,all.x=T,all.y=T)
head(mplants)
str(mplants) # 715 plants
head(mplants)
mplants %>% ncol() # 9 columns
mplants %>% names()
mplants%>%ncol() # 9 columns
names(mplants)
library(dplyr)
head(mplants)
mplants1<-read.table("./data/raw/tanga2016_plants1.txt",header=T,sep="\t",dec=".")
mplants2<-read.table("./data/raw/tanga2016_plants2.txt",header=T,sep="\t",dec=".")
mplants3<-read.table("./data/raw/tanga2016_plants3.txt",header=T,sep="\t",dec=".")
mplants1$plot_id<-as.factor(mplants1$plot_id)
mplants2$comments2<-as.character(mplants2$comments2)
mplants2$new_mark<-as.factor(mplants2$new_mark)
mplants2$plot_id<-as.factor(mplants2$plot_id)
mplants3$comments3<-as.character(mplants3$comments3)
head(mplants1)
tail(mplants1)
head(mplants2)
tail(mplants2)
head(mplants3)
tail(mplants3)
str(mplants1) #621 plants
str(mplants2) #708 plants
str(mplants3) #715 plants
head(subset(mplants2,new_mark==0)[1:7]) #Data from already marked plants on visit 2
str(subset(mplants2,new_mark==0)[1:7]) #614 plants
mplants<-merge(mplants1,subset(mplants2,new_mark==0)[1:7],all.x=T,all.y=T)
head(mplants)
str(mplants) #621
subset(mplants,is.na(new_mark)) #7 plants marked on visit 1 that had no data on visit 2
mplants[c("new_mark")][is.na(mplants[c("new_mark")])] <- 0
mplants[c("comments2")][is.na(mplants[c("comments2")])] <- "Not included in mplants2. This comment was manually typed in R"
subset(mplants,is.na(n_fl))
head(mplants)
str(mplants)
head(subset(mplants2,new_mark==1)) #Data from newly marked plants on visit 2
str(subset(mplants2,new_mark==1)) # 94 plants
mplants<-merge(mplants,subset(mplants2,new_mark==1),all.x=T,all.y=T)
head(mplants)
str(mplants) # 715 plants
mplants<-merge(mplants,mplants3,all.x=T,all.y=T)
head(mplants)
str(mplants) # 715 plants
names(mplants)
mplants <- select(mplants,
pl_id,plot_id,n_shoots,n_fl,shoot_h,phen,n_eggs_1,n_eggs_2,veg_h_1,veg_h_2,
bud_in,bud_pr,bud_ab,fl_in,fl_pr,fl_ab,fr_in,fr_inC,fr_pr,fr_prC,fr_ab,
new_mark,state_after_2,stage_after_3,comments2,comments3)
mplants <- select(mplants,
pl_id,plot_id,n_shoots,n_fl,shoot_h,phen,n_eggs_1,n_eggs_2,veg_h_1,veg_h_2,
bud_in,bud_pr,bud_ab,fl_in,fl_pr,fl_ab,fr_in,fr_inC,fr_pr,fr_prC,fr_ab,
new_mark,state_after_2,state_after_3,comments2,comments3)
names(mplants)
head(mplants)
with(mplants,plot(phen,n_eggs_1))
with(mplants,plot(phen,n_eggs_2))
?lineplot.CI
??lineplot.CI
library(sciplot)
?lineplot.CI
with(mplants,lineplot.CI(phen,n_eggs_1))
with(mplants,lineplot.CI(phen,n_eggs_2))
with(mplants,lineplot.CI(phen,max(n_eggs1,n_eggs_2)))
with(mplants,lineplot.CI(phen,n_eggs_1))
with(mplants,lineplot.CI(phen,n_eggs_2))
with(mplants,lineplot.CI(phen,max(n_eggs1,n_eggs_2)))
with(mplants,lineplot.CI(phen,max(n_eggs_1,n_eggs_2)))
with(mplants,lineplot.CI(phen,max(mplants$n_eggs_1,mplants$n_eggs_2)))
head(mplants)
write.dbf(dataframe, "./gis/tables/mplants.dbf", factor2char = TRUE, max_nchar = 250)
install.packages("foreign")
library(foreign)
write.dbf(dataframe, "./gis/tables/mplants.dbf", factor2char = TRUE, max_nchar = 250)
write.dbf(mplants, "./gis/tables/mplants.dbf", factor2char = TRUE, max_nchar = 250)
str(mplants) # 715 plants
names(mplants)
str(mplants) # 715 plants
mplants_dbf<-mplants
mplants_dbf[is.na(mplants_dbf[3:21])]<--9999
mplants_dbf[is.na(mplants_dbf[3:21])]<-9999
is.na(mplants_dbf[3:21])
mplants_dbf[, 3:21][is.na(mplants_dbf[, 3:21])] <- 0
mplants_dbf<-mplants
mplants_dbf[, 3:21][is.na(mplants_dbf[, 3:21])] <- -9999
names(mplants)
mplants_dbf[, 3:5][is.na(mplants_dbf[, 3:5])] <- -9999
mplants_dbf[, 7:21][is.na(mplants_dbf[, 7:21])] <- -9999
head(mplants_dbf)
write.dbf(mplants, "./gis/tables/mplants.dbf", factor2char = TRUE, max_nchar = 250)
write.dbf(mplants_dbf, "./gis/tables/mplants.dbf", factor2char = TRUE, max_nchar = 250)
mplants_dbf
head(mplants)
write.txt(mplants, "./data/clean/mplants.txt", sep="\t",dec=".")
write.table(mplants, "./data/clean/mplants.txt", sep="\t",dec=".")
?write.table
write.table(mplants, "./data/clean/mplants.txt", sep="\t",dec=".",row.names=F)
