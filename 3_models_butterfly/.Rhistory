geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
dev.off()
dev.off()
dev.off()
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/figS6.tiff",
res=600,width=13,height=11,units="cm",family="Times")
ggplot(df3,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
dev.off()
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/figS6.tiff",
res=600,width=13,height=11,units="cm",family="Times")
ggplot(df3,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
dev.off()
plot(correlog_model2)
abline(h=0) #Ignore autocorrelation at longer distances!
moran.mc_model2
ggplot(df4,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.3),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
df4<-data.frame(cbind(distance=as.vector(correlog_model2$mean.of.class[1:7]),
correlation=as.vector(correlog_model2$correlation[1:7]),
p=as.vector(correlog_model2$p[1:7])))
ggplot(df4,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.3),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
ggplot(df4,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(0,25),breaks=c(0,5,10,15,20,25)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.3),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
ggplot(df4,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.25),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/figS7.tiff",
res=600,width=13,height=11,units="cm",family="Times")
ggplot(df4,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.25),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
dev.off()
correlog_model2 <- correlog(subset(allplants,!is.na(phen)&n_eggs_max>0)$x,
subset(allplants,!is.na(phen)&n_eggs_max>0)$y,
res_model2,increment=1, resamp=100) #Rerun with 1000
plot(correlog_model2)
abline(h=0) #Ignore autocorrelation at longer distances!
ggplot(df4,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.25),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
correlog_model2
df4<-data.frame(cbind(distance=as.vector(correlog_model2$mean.of.class[1:17]),
correlation=as.vector(correlog_model2$correlation[1:17]),
p=as.vector(correlog_model2$p[1:17])))
ggplot(df4,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.25),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
df4<-data.frame(cbind(distance=as.vector(correlog_model2$mean.of.class[1:7]),
correlation=as.vector(correlog_model2$correlation[1:7]),
p=as.vector(correlog_model2$p[1:7])))
ggplot(df4,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(1,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.25),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
df4<-data.frame(cbind(distance=as.vector(correlog_model2$mean.of.class[1:7]),
correlation=as.vector(correlog_model2$correlation[1:7]),
p=as.vector(correlog_model2$p[1:7])))
ggplot(df4,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(1,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.25),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
ggplot(df4,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(1,30),breaks=c(1,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.25),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
correlog_model2 <- correlog(subset(allplants,!is.na(phen)&n_eggs_max>0)$x,
subset(allplants,!is.na(phen)&n_eggs_max>0)$y,
res_model2,increment=5, resamp=100) #Rerun with 1000
df4<-data.frame(cbind(distance=as.vector(correlog_model2$mean.of.class[1:7]),
correlation=as.vector(correlog_model2$correlation[1:7]),
p=as.vector(correlog_model2$p[1:7])))
ggplot(df4,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(1,30),breaks=c(1,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.25),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
ggplot(df4,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.25),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
?moran.test
allplants.listw2
?nb2listw
moran.mc_model1_ME<-moran.mc(res_model1_ME,listw=allplants.listw1,nsim=10000)
correlog_model1_1 <- correlog(subset(allplants,!is.na(phen))$x,
subset(allplants,!is.na(phen))$y,
res_model1,increment=1, resamp=100)
correlog_model1_ME_1 <- correlog(subset(allplants,!is.na(phen))$x,
subset(allplants,!is.na(phen))$y,
res_model1_ME,increment=1, resamp=100)
moran.mc_model1_ME
plot(correlog_model1_1)
plot(correlog_model1_ME_1)
library(fmsb)
library(effects)
library(ggplot2)
library(nlme)
library(spdep)
library(ncf)
library(gstat)
library(ggthemes)
library(RColorBrewer)
library(cowplot)
library(gridExtra)
moran.mc_model1_ME
plot(correlog_model1_1)
plot(correlog_model1_ME_1)
correlog_model1_1
?moran.plot
moran.plot(res_model1_ME,listw=allplants.listw1)
?moran
?sp.correlogram
moran(res_model1_ME,listw=allplants.listw1)
moran(res_model1_ME,listw=allplants.listw1,n=10)
class(allplants.listw1)
sp.correlogram(allplants.listw1)
sp.correlogram(allplants.nb1)
plot(correlog_model1_1)
plot(correlog_model1_ME_1)
df5<-data.frame(cbind(distance=as.vector(correlog_model1_1$mean.of.class[1:7]),
correlation=as.vector(correlog_model1_1$correlation[1:7]),
p=as.vector(correlog_model1_1$p[1:7])))
ggplot(data=df5,aes(x=distance, y=correlation)) +
geom_point(colour = "black", size = 2) +
geom_line(colour = "black") +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
df5<-data.frame(cbind(distance=as.vector(correlog_model1_1$mean.of.class[1:17]),
correlation=as.vector(correlog_model1_1$correlation[1:17]),
p=as.vector(correlog_model1_1$p[1:17])))
ggplot(data=df5,aes(x=distance, y=correlation)) +
geom_point(colour = "black", size = 2) +
geom_line(colour = "black") +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
df5<-data.frame(cbind(distance=as.vector(correlog_model1_1$mean.of.class[1:30]),
correlation=as.vector(correlog_model1_1$correlation[1:30]),
p=as.vector(correlog_model1_1$p[1:30])))
ggplot(data=df5,aes(x=distance, y=correlation)) +
geom_point(colour = "black", size = 2) +
geom_line(colour = "black") +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
df5<-data.frame(cbind(distance=as.vector(correlog_model1_1$mean.of.class[1:31]),
correlation=as.vector(correlog_model1_1$correlation[1:31]),
p=as.vector(correlog_model1_1$p[1:31])))
ggplot(data=df5,aes(x=distance, y=correlation)) +
geom_point(colour = "black", size = 2) +
geom_line(colour = "black") +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
df5<-data.frame(cbind(distance=as.vector(correlog_model1_1$mean.of.class[1:32]),
correlation=as.vector(correlog_model1_1$correlation[1:32]),
p=as.vector(correlog_model1_1$p[1:32])))
correlog_model2_1 <- correlog(subset(allplants,!is.na(phen)&n_eggs_max>0)$x,
subset(allplants,!is.na(phen)&n_eggs_max>0)$y,
res_model2,increment=1, resamp=100)
plot(correlog_model2_1)
plot(correlog_model1_1)
plot(correlog_model1_ME_1)
plot(correlog_model2_1)
df5<-data.frame(cbind(distance=as.vector(correlog_model1_1$mean.of.class[1:32]),
correlation=as.vector(correlog_model1_1$correlation[1:32]),
p=as.vector(correlog_model1_1$p[1:32])))
df6<-data.frame(cbind(distance=as.vector(correlog_model1_ME_1$mean.of.class[1:32]),
correlation=as.vector(correlog_model1_ME_1$correlation[1:32]),
p=as.vector(correlog_model1_ME_1$p[1:32])))
df5$type<-"model1_1"
df6$type<-"model1_ME_1"
df7<-rbind(df5,df5)
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
df7
df5<-data.frame(cbind(distance=as.vector(correlog_model1_1$mean.of.class[1:32]),
correlation=as.vector(correlog_model1_1$correlation[1:32]),
p=as.vector(correlog_model1_1$p[1:32])))
df6<-data.frame(cbind(distance=as.vector(correlog_model1_ME_1$mean.of.class[1:32]),
correlation=as.vector(correlog_model1_ME_1$correlation[1:32]),
p=as.vector(correlog_model1_ME_1$p[1:32])))
df5
df6
df5$type<-"model1_1"
df6$type<-"model1_ME_1"
df7<-rbind(df5,df6)
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
df8<-data.frame(cbind(distance=as.vector(correlog_model2_1$mean.of.class[1:32]),
correlation=as.vector(correlog_model2_1$correlation[1:32]),
p=as.vector(correlog_model2_1$p[1:32])))
df8
ggplot(df8,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.1,0.25),breaks = c(-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
df8
ggplot(df8,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line()
ggplot(df8,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.15,0.25),breaks = c(-0.15,-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type))
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.3,0.3),breaks = c(-0.3,-0.25,-0.20,-0.15,-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,35),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.3,0.3),breaks = c(-0.3,-0.25,-0.20,-0.15,-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
df5<-data.frame(cbind(distance=as.vector(correlog_model1_1$mean.of.class[1:31]),
correlation=as.vector(correlog_model1_1$correlation[1:31]),
p=as.vector(correlog_model1_1$p[1:31])))
ggplot(data=df5,aes(x=distance, y=correlation)) +
geom_point(colour = "black", size = 2) +
geom_line(colour = "black") +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
df6<-data.frame(cbind(distance=as.vector(correlog_model1_ME_1$mean.of.class[1:31]),
correlation=as.vector(correlog_model1_ME_1$correlation[1:31]),
p=as.vector(correlog_model1_ME_1$p[1:31])))
ggplot(data=df6,aes(x=distance, y=correlation)) +
geom_point(colour = "red", size = 2) +
geom_line(colour = "red") +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))
df5$type<-"model1_1"
df6$type<-"model1_ME_1"
df7<-rbind(df5,df6)
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,35),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.3,0.3),breaks = c(-0.3,-0.25,-0.20,-0.15,-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.3,0.3),breaks = c(-0.3,-0.25,-0.20,-0.15,-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(1,30),breaks=c(1,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(1,30),breaks=c(1,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.05),breaks = c(-0.05,0,0.05))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
df8<-data.frame(cbind(distance=as.vector(correlog_model2_1$mean.of.class[1:31]),
correlation=as.vector(correlog_model2_1$correlation[1:31]),
p=as.vector(correlog_model2_1$p[1:31])))
ggplot(df8,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.15,0.25),breaks = c(-0.15,-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/figS6_1.tiff",
res=600,width=13,height=11,units="cm",family="Times")
ggplot(df7,aes(x=distance, y=correlation)) +
geom_point(aes(colour=type),size=2) +
geom_line(aes(colour=type)) +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.05,0.3),breaks = c(-0.05,0,0.05,0.1,0.15,0.20,0.25,0.30))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
dev.off()
df8<-data.frame(cbind(distance=as.vector(correlog_model2_1$mean.of.class[1:31]),
correlation=as.vector(correlog_model2_1$correlation[1:31]),
p=as.vector(correlog_model2_1$p[1:31])))
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/figS7_1.tiff",
res=600,width=13,height=11,units="cm",family="Times")
ggplot(df8,aes(x=distance, y=correlation)) +
geom_point(size=2) +
geom_line() +
scale_x_continuous("Distance (mean of class)",limits=c(0,30),breaks=c(0,5,10,15,20,25,30)) +
scale_y_continuous("Correlation (Moran's I)",limits=c(-0.15,0.25),breaks = c(-0.15,-0.1,-0.05,0,0.05,0.1,0.15,0.20,0.25))+
geom_hline(aes(yintercept=0), colour="darkgrey")+
theme_base()+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(legend.position="none")+theme(text=element_text(family="serif"))
dev.off()
summary(model1)
head(allplants)
model1<-glm(attack ~ scale(phen_int) + scale(Mrub_sch_s) + scale(pldens_3) +
scale(phen_n3) + scale(phen_int):scale(Mrub_sch_s)+
scale(phen_int):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(allplants_df,!is.na(phen)),family="binomial") #MODEL TO USE!
summary(model1)
model1<-glm(attack ~ scale(phen_int) + scale(Mrub_sch_s) + scale(pldens_3) +
scale(phen_n3) + scale(phen_int):scale(Mrub_sch_s)+
scale(phen_int):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(as.data.frame(allplants),!is.na(phen)),family="binomial") #MODEL TO USE!
summary(model1)
head(as.data.frame(allplants))
str(as.data.frame(allplants))
allplants_norep$xy<-allplants_norep$x*allplants_norep$y
allplants_norep<-as.data.frame(allplants)
allplants_norep$xy<-allplants_norep$x*allplants_norep$y
head(allplants_norep)
plot(allplants_norep$xy)
hist(allplants_norep$xy)
str(allplants_norep)
head(allplants_norep)
allplants_norep<-allplants_norep[!duplicated(allplants_norep$xy),]
str(allplants_norep)
str(subset(allplants_norep,!is.na(phen)))
model1<-glm(attack ~ scale(phen_int) + scale(Mrub_sch_s) + scale(pldens_3) +
scale(phen_n3) + scale(phen_int):scale(Mrub_sch_s)+
scale(phen_int):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(allplants_norep,!is.na(phen)),family="binomial") #MODEL TO USE!
summary(model1)
NagelkerkeR2(model1)
res_model1<-residuals(model1)
correlog_model1 <- correlog(subset(allplants_norep,!is.na(phen))$x,
subset(allplants_norep,!is.na(phen))$y,
res_model1,increment=5, resamp=100)
plot(correlog_model1)
summary(model1)
model1<-glm(attack ~ scale(phen_int) + scale(Mrub_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen_int):scale(Mrub_sum)+
scale(phen_int):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(allplants_norep,!is.na(phen)),family="binomial") #MODEL TO USE!
summary(model1)
model1<-glm(attack ~ scale(phen_int) + scale(Msch_sum) + scale(pldens_3) +
scale(phen_n3) + scale(phen_int):scale(Msch_sum)+
scale(phen_int):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(allplants_norep,!is.na(phen)),family="binomial") #MODEL TO USE!
summary(model1)
model1<-glm(attack ~ scale(phen_int) + scale(Mrub_pres) + scale(pldens_3) +
scale(phen_n3) + scale(phen_int):scale(Mrub_pres)+
scale(phen_int):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(allplants_norep,!is.na(phen)),family="binomial") #MODEL TO USE!
summary(model1)
model1<-glm(attack ~ scale(phen_int) + scale(Mrub_max) + scale(pldens_3) +
scale(phen_n3) + scale(phen_int):scale(Mrub_max)+
scale(phen_int):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(allplants_norep,!is.na(phen)),family="binomial") #MODEL TO USE!
summary(model1)
names(allplants)
model1<-glm(attack ~ scale(phen_int) + scale(Mrub_p) + scale(pldens_3) +
scale(phen_n3) + scale(phen_int):scale(Mrub_p)+
scale(phen_int):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(allplants_norep,!is.na(phen)),family="binomial") #MODEL TO USE!
summary(model1)
model1<-glm(attack ~ scale(phen_int) + scale(Mrub_sch_s) + scale(pldens_3) +
scale(phen_n3) + scale(phen_int):scale(Mrub_sch_s)+
scale(phen_int):scale(phen_n3) + scale(pldens_3):scale(phen_n3),
subset(allplants,!is.na(phen)),family="binomial") #MODEL TO USE!
summary(model1)
NagelkerkeR2(model1)
res_model1<-residuals(model1)
