draw_label(label="B)",x=0.53,y=0.83, fontfamily = "serif", fontface = 1)
ggdraw()+
draw_plot(p2,0.02,0,0.45,0.81)+
draw_plot(p5,1/2,0,0.45,1)+
draw_label(label="A)",x=0.01,y=0.81, fontfamily = "serif", fontface = 1)+
draw_label(label="B)",x=0.53,y=0.81, fontfamily = "serif", fontface = 1)
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3.tiff",
res=600,width=22,height=11,units="cm",family="Times")
ggdraw()+
draw_plot(p2,0.02,0,0.45,0.81)+
draw_plot(p5,1/2,0,0.45,1)+
draw_label(label="A)",x=0.01,y=0.81, fontfamily = "serif", fontface = 1)+
draw_label(label="B)",x=0.53,y=0.81, fontfamily = "serif", fontface = 1)
dev.off()
dev.off()
ggdraw()+
draw_plot(p2,0.02,0,0.45,0.81)+
draw_plot(p5,1/2,0,0.45,1)+
draw_label(label="A)",x=0.01,y=0.81, fontfamily = "serif", fontface = 1)+
draw_label(label="B)",x=0.53,y=0.81, fontfamily = "serif", fontface = 1)
dev.off()
dev.off()
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3.tiff",
res=600,width=22,height=11,units="cm",family="Times")
ggdraw()+
draw_plot(p2,0.02,0,0.45,0.81)+
draw_plot(p5,1/2,0,0.45,1)+
draw_label(label="A)",x=0.01,y=0.81, fontfamily = "serif", fontface = 1)+
draw_label(label="B)",x=0.53,y=0.81, fontfamily = "serif", fontface = 1)
dev.off()
dev.off()
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3.tiff",
res=600,width=22,height=11,units="cm",family="Times")
ggdraw()+
draw_plot(p2,0.02,0,0.45,0.82)+
draw_plot(p5,1/2,0,0.45,1)+
draw_label(label="A)",x=0.01,y=0.81, fontfamily = "serif", fontface = 1)+
draw_label(label="B)",x=0.53,y=0.81, fontfamily = "serif", fontface = 1)
dev.off()
dev.off()
dev.off()
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3.tiff",
res=600,width=22,height=11,units="cm",family="Times")
ggdraw()+
draw_plot(p2,0.02,0,0.45,0.83)+
draw_plot(p5,1/2,0,0.45,1)+
draw_label(label="A)",x=0.01,y=0.81, fontfamily = "serif", fontface = 1)+
draw_label(label="B)",x=0.53,y=0.81, fontfamily = "serif", fontface = 1)
dev.off()
dev.off()
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3.tiff",
res=600,width=22,height=11,units="cm",family="Times")
ggdraw()+
draw_plot(p2,0.02,0,0.45,0.83)+
draw_plot(p5,1/2,0,0.45,1)+
draw_label(label="A)",x=0.01,y=0.81, fontfamily = "serif", fontface = 1)+
draw_label(label="B)",x=0.53,y=0.81, fontfamily = "serif", fontface = 1)
dev.off()
dev.off()
p1<-ggplot(interaction1, aes(phen_int,fit, group = as.factor(Mrub_sch_s)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen_int,fit,color=Mrub_sch_s))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
p2<-ggplot(interaction2, aes(pldens_3,fit, group = as.factor(phen_n3)))+
geom_smooth(method=loess,se=F,size=0.3,aes(pldens_3,fit,color=phen_n3))+
xlab("Neighbor density")+ylab("Probability of having eggs")+
theme_base()+ scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="none")+labs(colour="Neighbor phenology")+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
p3<-ggplot(effect1, aes(phen_int,fit))+
geom_smooth(method=loess,se=T,size=1,color="black",aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Number of eggs")+theme_base()+
scale_x_continuous(breaks=c(1,2,3,4,5,6))+scale_y_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))+
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.5,fill="grey")
p4<-ggplot(effect2, aes(Mrub_sch_s,fit))+
geom_smooth(method=loess,se=T,size=1,color="black",aes(Mrub_sch_s,fit))+
xlab("Ant abundance")+ylab("Number of eggs")+theme_base()+
scale_x_continuous(breaks=c(0,5,10,15,20,25,30,35))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))+
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.5,fill="grey")
p5<-ggplot(interaction3, aes(pldens_3,fit, group = as.factor(phen_n3)))+
geom_smooth(method=loess,se=F,size=0.3,aes(pldens_3,fit,color=phen_n3))+
xlab("Neighbor density")+ylab("Number of eggs")+
theme_base()+ scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Neigh. phenology")+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2.tiff",
res=600,width=26,height=9,units="cm",family="Times")
ggdraw()+
draw_plot(p1,0.02,0.01,0.3,1)+
draw_plot(p3,1/3+0.04,0.01,0.3,0.81)+
draw_plot(p4,2/3+0.04,0.01,0.3,0.81)+
draw_label(label="A)",x=0.01,y=0.8, fontfamily = "serif", fontface = 1)+
draw_label(label="B)",x=0.39,y=0.8, fontfamily = "serif", fontface = 1)+
draw_label(label="C)",x=0.73,y=0.8, fontfamily = "serif", fontface = 1)
dev.off()
dev.off()
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3.tiff",
res=600,width=22,height=11,units="cm",family="Times")
ggdraw()+
draw_plot(p2,0.02,0,0.45,0.83)+
draw_plot(p5,1/2,0,0.45,1)+
draw_label(label="A)",x=0.01,y=0.81, fontfamily = "serif", fontface = 1)+
draw_label(label="B)",x=0.53,y=0.81, fontfamily = "serif", fontface = 1)
dev.off()
str(subset(allplants,!is.na(phen)))
str(allplants)
str(subset(allplants,!is.na(phen)&n_eggs_max>0))
nobs(subset(allplants,!is.na(phen)&n_eggs_max>0))
nobs(model2)
head(subset(allplants,!is.na(phen)&n_eggs_max>0))
with(subset(allplants,!is.na(phen)&n_eggs_max>0),plot(subset(allplants,!is.na(phen)&n_eggs_max>0)))
with(subset(allplants,!is.na(phen)&n_eggs_max>0),plot(n_eggs_max))
plot(subset(allplants,!is.na(phen)&n_eggs_max>0)$n_eggs_max)
histt(subset(allplants,!is.na(phen)&n_eggs_max>0)$n_eggs_max)
hist(subset(allplants,!is.na(phen)&n_eggs_max>0)$n_eggs_max)
mean(subset(allplants,!is.na(phen)&n_eggs_max>0)$n_eggs_max)
boxplot(subset(allplants,!is.na(phen)&n_eggs_max>0)$n_eggs_max)
?stderr
library(plotrix)
std.error(subset(allplants,!is.na(phen)&n_eggs_max>0)$n_eggs_max)
73100/8848
p1
interaction1
interaction1
View(interaction1)
subset(interaction1,M_rub_sch_s==0)
subset(interaction1,Mrub_sch_s==0)
subset(interaction1,Mrub_sch_s==0&Mrub_sch_s>25)
subset(interaction1,Mrub_sch_s==0)
subset(interaction1,Mrub_sch_s>25)
subset(interaction1,Mrub_sch_s<3)
subset(interaction1,Mrub_sch_s>25)
subset(interaction1,Mrub_sch_s<3)
subset(interaction1,Mrub_sch_s>30)
subset(interaction1,Mrub_sch_s<3)
subset(interaction1,Mrub_sch_s>31)
hist(subset(allplants,!is.na(phen))$Mrub_sch_s)
range(subset(allplants,!is.na(phen))$Mrub_sch_s)
3.950119e-01
4.099642e-01
subset(interaction1,Mrub_sch_s==17)
subset(interaction1,Mrub_sch_s==1)
hist(subset(allplants,!is.na(phen)&n_eggs_max>0)$Mrub_sch_s)
range(subset(allplants,!is.na(phen)&n_eggs_max>0)$Mrub_sch_s)
plot(subset(allplants,!is.na(phen)&n_eggs_max>0)$Mrub_sch_s)
subset(allplants,!is.na(phen)&n_eggs_max>0&Mrub_sch_s==0)
library(fmsb)
library(effects)
library(ggplot2)
library(nlme)
library(spdep)
library(ncf)
library(gstat)
library(ggthemes)
library(RColorBrewer)
library(cowplot)
library(gridExtra)
p1
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_A.tiff",
res=600,width=26,height=9,units="cm",family="Times")
p1
dev.off()
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_A.tiff",
res=600,width=26,height=9,units="cm",family="Times")
p1
dev.off()
dev.off()
dev.off()
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_A.tiff",
res=600,width=26,height=9,units="cm",family="Times")
p1
warnings()
dev.off()
dev.off()
dev.off()
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_A.tiff",
res=600,width=26,height=9,units="cm",family="Times")
ggplot(interaction1, aes(phen_int,fit, group = as.factor(Mrub_sch_s)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen_int,fit,color=Mrub_sch_s))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
tiff("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_A.tiff",
res=600,width=9,height=9,units="cm",family="Times")
ggplot(interaction1, aes(phen_int,fit, group = as.factor(Mrub_sch_s)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen_int,fit,color=Mrub_sch_s))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
pdf("C:/Users/Ali/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_A.tiff",
res=600,width=9,height=9,units="cm",family="Times")
ggplot(interaction1, aes(phen_int,fit, group = as.factor(Mrub_sch_s)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen_int,fit,color=Mrub_sch_s))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
warnings()
ggplot(interaction1, aes(phen_int,fit, group = as.factor(Mrub_sch_s)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen_int,fit,color=Mrub_sch_s))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
warnings()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_A.tiff",
res=600,width=9,height=9,units="cm",family="Times")
ggplot(interaction1, aes(phen_int,fit, group = as.factor(Mrub_sch_s)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen_int,fit,color=Mrub_sch_s))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_A.tiff",
res=600,width=9,height=9,units="cm",family="Times")
p1
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_B.tiff",
res=600,width=9,height=9,units="cm",family="Times")
p2
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_C.tiff",
res=600,width=9,height=9,units="cm",family="Times")
p3
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_A.tiff",
res=600,width=9,height=11,units="cm",family="Times")
p1
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_B.tiff",
res=600,width=10,height=9,units="cm",family="Times")
p2
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_B.tiff",
res=600,width=9,height=9,units="cm",family="Times")
p3
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_C.tiff",
res=600,width=9,height=9,units="cm",family="Times")
p4
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_A.tiff",
res=600,width=10,height=11,units="cm",family="Times")
p1
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_B.tiff",
res=600,width=9,height=9,units="cm",family="Times")
p3
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_C.tiff",
res=600,width=9,height=9,units="cm",family="Times")
p4
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3_A.tiff",
res=600,width=9,height=9,units="cm",family="Times")
p2
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3_B.tiff",
res=600,width=9,height=9,units="cm",family="Times")
p5
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3_B.tiff",
res=600,width=9,height=11,units="cm",family="Times")
p5
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3_A.tiff",
res=600,width=9,height=9,units="cm",family="Times")
ggplot(interaction2, aes(pldens_3,fit, group = as.factor(phen_n3)))+
geom_smooth(method=loess,se=F,size=0.3,aes(pldens_3,fit,color=phen_n3))+
xlab("Neighbor density")+ylab("Probability of having eggs")+
theme_base()+ scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Neighbor phenology")+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3_B.tiff",
res=600,width=9,height=9,units="cm",family="Times")
p5
dev.off()
dev.off()
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3_A.tiff",
res=600,width=9,height=9,units="cm",family="Times")
ggplot(interaction2, aes(pldens_3,fit, group = as.factor(phen_n3)))+
geom_smooth(method=loess,se=F,size=0.3,aes(pldens_3,fit,color=phen_n3))+
xlab("Neighbor density")+ylab("Probability of having eggs")+
theme_base()+ scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Neighbor phenology")+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3_B.tiff",
res=600,width=9,height=9,units="cm",family="Times")
p5
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3_B.tiff",
res=600,width=8,height=9,units="cm",family="Times")
dev.off()
p5
dev.off()
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3_B.tiff",
res=600,width=8,height=9,units="cm",family="Times")
p5
dev.off()
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3_B.tiff",
res=600,width=9,height=9,units="cm",family="Times")
p5
dev.off()
p1
ggplot(interaction1, aes(phen_int,fit))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+
theme(legend.position="top")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
interaction1
fit
ggplot(interaction1, aes(phen_int,fit))+
geom_smooth(method=loess,se=F,size=1,aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+
theme(legend.position="top")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig2_A_mean.tiff",
res=600,width=9,height=9,units="cm",family="Times")
ggplot(interaction1, aes(phen_int,fit))+
geom_smooth(method=loess,se=F,size=1,aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+
theme(legend.position="top")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
ggplot(interaction2, aes(pldens_3,fit))+
geom_smooth(method=loess,se=F,size=1,aes(pldens_3,fit))+
xlab("Neighbor density")+ylab("Probability of having eggs")+
theme_base()+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3_A_mean.tiff",
res=600,width=9,height=9,units="cm",family="Times")
ggplot(interaction2, aes(pldens_3,fit))+
geom_smooth(method=loess,se=F,size=1,aes(pldens_3,fit))+
xlab("Neighbor density")+ylab("Probability of having eggs")+
theme_base()+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
ggplot(interaction3, aes(pldens_3,fit))+
geom_smooth(method=loess,se=F,size=1,aes(pldens_3,fit))+
xlab("Neighbor density")+ylab("Number of eggs")+
theme_base()+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
tiff("C:/Users/Alicia/Dropbox/SU/Projects/neighbourhood_effects/results/butterfly/figures/fig3_B_mean.tiff",
res=600,width=9,height=9,units="cm",family="Times")
ggplot(interaction3, aes(pldens_3,fit))+
geom_smooth(method=loess,se=F,size=1,aes(pldens_3,fit))+
xlab("Neighbor density")+ylab("Number of eggs")+
theme_base()+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
p1
library(ggplot2)
p1
p2
p3
p4
ggplot(interaction2, aes(pldens_3,fit, group = as.factor(phen_n3)))+
geom_smooth(method=loess,se=F,size=0.3,aes(pldens_3,fit,color=phen_n3))+
xlab("Neighbor density")+ylab("Probability of having eggs")+
theme_base()+ scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Neighbor phenology")+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
library(ggthemes)
ggplot(interaction2, aes(pldens_3,fit, group = as.factor(phen_n3)))+
geom_smooth(method=loess,se=F,size=0.3,aes(pldens_3,fit,color=phen_n3))+
xlab("Neighbor density")+ylab("Probability of having eggs")+
theme_base()+ scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Neighbor phenology")+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(interaction1, aes(phen_int,fit))+
geom_smooth(method=loess,se=F,size=1,aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+
theme(legend.position="top")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(interaction1, aes(phen_int,fit))+
geom_smooth(method=loess,se=F,size=1,aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+
theme(legend.position="top")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
p3
ggplot(interaction1, aes(phen_int,fit))+
geom_smooth(method=loess,se=F,size=1,aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+
theme(legend.position="top")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))+
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.5,fill="grey")
ggplot(interaction1, aes(phen_int,fit))+
geom_smooth(method=loess,se=F,size=1,aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+
theme(legend.position="top")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))+
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.5,fill="grey")
model2
effectin<-data.frame(effect(term="scale(phen_int)", mod=model1_ME,
xlevels=list(phen_int=1:6)))
library(effects)
effectin<-data.frame(effect(term="scale(phen_int)", mod=model1_ME,
xlevels=list(phen_int=1:6)))
ggplot(effectin, aes(phen_int,fit))+
geom_smooth(method=loess,se=T,size=1,color="black",aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+
scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))+
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.5,fill="grey")
ggplot(interaction1, aes(phen_int,fit))+
geom_smooth(method=loess,se=F,size=1,aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+
theme(legend.position="top")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))+
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.5,fill="grey")
ggplot(interaction1, aes(phen_int,fit))+
geom_smooth(method=loess,se=F,size=1,aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+
theme(legend.position="top")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
effectin
ggplot(as.data.frame(allplants), aes(phen_int,seeds_per_fl))+
geom_smooth(method=loess,se=T,size=1,color="black",aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Seeds per flower")+theme_base()+
scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))+
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.5,fill="grey")
ggplot(as.data.frame(allplants), aes(phen_int,seeds_per_fl))+
geom_smooth(method=loess,se=T,size=1,color="black",aes(phen_int,seeds_per_fl))+
xlab("Shoot phenology")+ylab("Seeds per flower")+theme_base()+
scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))+
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.5,fill="grey")
head(as.data.frame(allplants))
as.data.frame(allplants)$seeds_per_fl
head(allplants)
library(fmsb)
library(effects)
library(ggplot2)
library(nlme)
library(spdep)
library(ncf)
library(gstat)
library(ggthemes)
library(RColorBrewer)
library(cowplot)
library(gridExtra)
#Graphs ####
plot(effect(term="scale(phen_int):scale(Mrub_sch_s)",
mod=model1_ME,data=subset(allplants,!is.na(phen))),
x.var="phen_int",multiline=T,type="response")
plot(effect(term="scale(pldens_3):scale(phen_n3)",
mod=model1_ME,data=subset(allplants,!is.na(phen))),
x.var="pldens_3",multiline=T,type="response")
plot(effect(term="scale(phen_int)",
mod=model2,data=subset(allplants,!is.na(phen)&n_eggs_max>0)),multiline=T,type="response")
plot(effect(term="scale(Mrub_sch_s)",
mod=model2,data=subset(allplants,!is.na(phen)&n_eggs_max>0)),multiline=T,type="response")
plot(effect(term="scale(pldens_3):scale(phen_n3)",
mod=model2,data=subset(allplants,!is.na(phen)&n_eggs_max>0)),
x.var="pldens_3",multiline=T,type="response")
p1<-ggplot(interaction1, aes(phen_int,fit, group = as.factor(Mrub_sch_s)))+
geom_smooth(method=loess,se=F,size=0.3,aes(phen_int,fit,color=Mrub_sch_s))+
xlab("Shoot phenology")+ylab("Probability of having eggs")+theme_base()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Ant abundance")+scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
p2<-ggplot(interaction2, aes(pldens_3,fit, group = as.factor(phen_n3)))+
geom_smooth(method=loess,se=F,size=0.3,aes(pldens_3,fit,color=phen_n3))+
xlab("Neighbor density")+ylab("Probability of having eggs")+
theme_base()+ scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="none")+labs(colour="Neighbor phenology")+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
p3<-ggplot(effect1, aes(phen_int,fit))+
geom_smooth(method=loess,se=T,size=1,color="black",aes(phen_int,fit))+
xlab("Shoot phenology")+ylab("Number of eggs")+theme_base()+
scale_x_continuous(breaks=c(1,2,3,4,5,6))+scale_y_continuous(breaks=c(1,2,3,4,5,6))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))+
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.5,fill="grey")
p4<-ggplot(effect2, aes(Mrub_sch_s,fit))+
geom_smooth(method=loess,se=T,size=1,color="black",aes(Mrub_sch_s,fit))+
xlab("Ant abundance")+ylab("Number of eggs")+theme_base()+
scale_x_continuous(breaks=c(0,5,10,15,20,25,30,35))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16))+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))+
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.5,fill="grey")
p5<-ggplot(interaction3, aes(pldens_3,fit, group = as.factor(phen_n3)))+
geom_smooth(method=loess,se=F,size=0.3,aes(pldens_3,fit,color=phen_n3))+
xlab("Neighbor density")+ylab("Number of eggs")+
theme_base()+ scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Neigh. phenology")+
theme(text=element_text(family="serif"))+theme(plot.background=element_rect(fill="white", colour=NA))
ggdraw()+
draw_plot(p1,0.02,0.01,0.3,1)+
draw_plot(p3,1/3+0.04,0.01,0.3,0.81)+
draw_plot(p4,2/3+0.04,0.01,0.3,0.81)+
draw_label(label="A)",x=0.01,y=0.8, fontfamily = "serif", fontface = 1)+
draw_label(label="B)",x=0.39,y=0.8, fontfamily = "serif", fontface = 1)+
draw_label(label="C)",x=0.73,y=0.8, fontfamily = "serif", fontface = 1)
ggdraw()+
draw_plot(p2,0.02,0,0.45,0.83)+
draw_plot(p5,1/2,0,0.45,1)+
draw_label(label="A)",x=0.01,y=0.81, fontfamily = "serif", fontface = 1)+
draw_label(label="B)",x=0.53,y=0.81, fontfamily = "serif", fontface = 1)
moran_model1_ME
moran.mc_model1_ME
moran.mc_model1_ME
moran_model1_ME_1v #Better with both vectors
moran_model1_ME #ONLY LITTLE AUTOCORRELATION LEFT
